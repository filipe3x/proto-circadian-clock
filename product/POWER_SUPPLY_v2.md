# Power Supply v2 - USB-C Power Delivery

Este documento descreve uma nova arquitetura de alimentaÃ§Ã£o baseada em USB-C, inspirada no design do [Adafruit Matrix Portal S3](https://www.adafruit.com/product/5778) e no modelo de alimentaÃ§Ã£o do Raspberry Pi 5. O objetivo Ã© simplificar o PCB eliminando a necessidade de uma fonte DC dedicada.

---

## 1. VisÃ£o Geral

### 1.1 Filosofia de Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      POWER SUPPLY v1 vs v2                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   v1 (Atual)                         v2 (Novo - USB-C)                      â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•                         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                       â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚   â”‚ FONTE DC â”‚                       â”‚ FONTE    â”‚                           â”‚
â”‚   â”‚ 5V/5A    â”‚                       â”‚ USB-C PD â”‚                           â”‚
â”‚   â”‚ 5.5x2.1mmâ”‚                       â”‚ 45-65W   â”‚                           â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚        â”‚                                  â”‚                                 â”‚
â”‚        â–¼                                  â–¼                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚   â”‚ DC JACK â”‚                       â”‚  USB-C    â”‚                           â”‚
â”‚   â”‚ on PCB  â”‚                       â”‚ Connector â”‚                           â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚        â”‚                                  â”‚                                 â”‚
â”‚        â”‚                            â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                           â”‚
â”‚        â”‚                            â”‚PD Controller                          â”‚
â”‚        â”‚                            â”‚(opcional) â”‚                           â”‚
â”‚        â”‚                            â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚        â”‚                                  â”‚                                 â”‚
â”‚        â–¼                                  â–¼                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚   â”‚ Painel  â”‚                       â”‚ Terminais â”‚                           â”‚
â”‚   â”‚  + PCB  â”‚                       â”‚ Parafuso  â”‚                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                           â”‚                                 â”‚
â”‚                                           â–¼                                 â”‚
â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                                      â”‚ Painel  â”‚                            â”‚
â”‚                                      â”‚  + PCB  â”‚                            â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                             â”‚
â”‚   Vantagens v2:                                                             â”‚
â”‚   âœ“ Fonte USB-C universal (telemÃ³vel, laptop, etc.)                        â”‚
â”‚   âœ“ Mais seguro (baixa tensÃ£o)                                             â”‚
â”‚   âœ“ PCB mais simples e compacto                                            â”‚
â”‚   âœ“ Cabo USB-C de qualidade Ã© fÃ¡cil de obter                               â”‚
â”‚   âœ“ Terminais de parafuso para ligaÃ§Ã£o robusta ao painel                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Duas EstratÃ©gias PossÃ­veis

| EstratÃ©gia | DescriÃ§Ã£o | Complexidade | Fiabilidade |
|------------|-----------|--------------|-------------|
| **A: 5V Direto** | USB-C 5V/5A direto (estilo Matrix Portal S3) | Baixa | MÃ©dia |
| **B: TensÃ£o Alta + Buck** | USB-C 9V/12V/20V + step-down para 5V | MÃ©dia | Alta |

---

## 2. EstratÃ©gia A: 5V/5A Direto (Estilo Adafruit)

### 2.1 Conceito

Baseado no [Adafruit Matrix Portal S3](https://learn.adafruit.com/adafruit-matrixportal-s3/usb-power), a alimentaÃ§Ã£o 5V entra diretamente pela porta USB-C e Ã© distribuÃ­da para o painel atravÃ©s de terminais de parafuso.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESTRATÃ‰GIA A: 5V DIRETO                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚            â”‚      â”‚                    PCB                          â”‚  â”‚
â”‚   â”‚  FONTE     â”‚      â”‚                                                 â”‚  â”‚
â”‚   â”‚  USB-C     â”‚      â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  5V/5A     â”œâ”€â”€â”€â”€â”€â”€â”¤â”€â”€â–ºâ”‚ USB-C  â”‚â”€â”€â”€â–ºâ”‚ FUSÃVEL â”‚â”€â”€â”€â–ºâ”‚ TERMINAIS  â”‚  â”‚  â”‚
â”‚   â”‚  (25W)     â”‚      â”‚   â”‚ Recept.â”‚    â”‚ + TVS   â”‚    â”‚ PARAFUSO   â”‚  â”‚  â”‚
â”‚   â”‚            â”‚      â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚        â”‚             â”‚               â”‚         â”‚  â”‚
â”‚                       â”‚        â”‚             â”‚               â”‚         â”‚  â”‚
â”‚                       â”‚        â–¼             â”‚               â–¼         â”‚  â”‚
â”‚                       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚                       â”‚   â”‚ CH340C â”‚         â”‚         â”‚  PAINEL   â”‚   â”‚  â”‚
â”‚                       â”‚   â”‚ USB-   â”‚         â”‚         â”‚   P10     â”‚   â”‚  â”‚
â”‚                       â”‚   â”‚ UART   â”‚         â”‚         â”‚ 32x16 RGB â”‚   â”‚  â”‚
â”‚                       â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚                       â”‚        â”‚             â”‚                         â”‚  â”‚
â”‚                       â”‚        â”‚             â–¼                         â”‚  â”‚
â”‚                       â”‚        â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚  â”‚
â”‚                       â”‚        â”‚       â”‚ AP2112K  â”‚                    â”‚  â”‚
â”‚                       â”‚        â”‚       â”‚  3.3V    â”‚                    â”‚  â”‚
â”‚                       â”‚        â”‚       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â”‚  â”‚
â”‚                       â”‚        â”‚            â”‚                          â”‚  â”‚
â”‚                       â”‚        â–¼            â–¼                          â”‚  â”‚
â”‚                       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â”‚
â”‚                       â”‚   â”‚      ESP32          â”‚                      â”‚  â”‚
â”‚                       â”‚   â”‚   (3.3V logic)      â”‚                      â”‚  â”‚
â”‚                       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
â”‚                       â”‚                                                 â”‚  â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 O Problema do 5V/5A no USB-C

O Raspberry Pi 5 [enfrenta o mesmo desafio](https://forums.raspberrypi.com/viewtopic.php?t=357395): **poucos carregadores USB-C suportam 5V/5A**.

```
USB Power Delivery (PD) - Perfis Comuns:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  TensÃ£o â”‚ Corrente TÃ­pica â”‚ PotÃªncia â”‚ Disponibilidade
  â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   5V    â”‚ 3A              â”‚ 15W      â”‚ âœ“ MUITO COMUM
   5V    â”‚ 5A              â”‚ 25W      â”‚ âœ— RARO (requer cabo 5A e-marked)
   9V    â”‚ 3A              â”‚ 27W      â”‚ âœ“ COMUM
   12V   â”‚ 3A              â”‚ 36W      â”‚ ~ MÃ‰DIO (PD 2.0, obsoleto em PD 3.1)
   15V   â”‚ 3A              â”‚ 45W      â”‚ âœ“ COMUM
   20V   â”‚ 3A              â”‚ 60W      â”‚ âœ“ MUITO COMUM
   20V   â”‚ 5A              â”‚ 100W     â”‚ âœ“ COMUM (laptops)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âš ï¸ PROBLEMA: O perfil 5V/5A (25W) Ã© RARO!

  Motivos:
  1. Requer cabo USB-C com e-marker para >3A
  2. Fabricantes preferem subir tensÃ£o (mais eficiente)
  3. EspecificaÃ§Ã£o PD nÃ£o obriga 5V/5A

  ğŸ“Œ SoluÃ§Ã£o RPi5: Fonte oficial com chip PD proprietÃ¡rio
  ğŸ“Œ Alternativa: Override por software (usb_max_current_enable)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2.3 ImplementaÃ§Ã£o 5V Direto (Sem PD Controller)

Para fontes que fornecem 5V fixo (como carregadores bÃ¡sicos ou a fonte oficial RPi5):

```
Circuito Simplificado (Sem negociaÃ§Ã£o PD):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                          USB-C Receptacle
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     VBUS (A4,A9,B4,B9) â”€â”¤ VBUS            â”‚
                         â”‚                 â”‚
                  GND â”€â”€â”€â”¤ GND             â”‚
                         â”‚                 â”‚
                  D+ â”€â”€â”€â”€â”¤ D+ (A6,B6)      â”‚  â†’ CH340C (dados)
                  D- â”€â”€â”€â”€â”¤ D- (A7,B7)      â”‚  â†’ CH340C (dados)
                         â”‚                 â”‚
           CC1 (A5) â”€â”€â”€â”€â”€â”¤ CC1   â”Œâ”€[5.1k]â”€â”€â”´â”€â”€ GND
           CC2 (B5) â”€â”€â”€â”€â”€â”¤ CC2   â””â”€[5.1k]â”€â”€â”´â”€â”€ GND
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ VBUS = 5V
                                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                           â”‚                               â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚    â”‚ F1: PTC 3A      â”‚    â”‚    â”‚ D1: SMBJ5.0A TVS    â”‚   â”‚
    â”‚    â”‚ MF-MSMF300      â”‚    â”‚    â”‚                     â”‚   â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚             â”‚             â”‚               â”‚               â”‚
    â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚                           â”‚                               â”‚
    â”‚                           â–¼                               â”‚
    â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                        â”‚
    â”‚              C1    â”‚   100ÂµF     â”‚   C2                   â”‚
    â”‚             470ÂµF  â”‚   CerÃ¢mico  â”‚  100nF                 â”‚
    â”‚              16V   â”‚   10V       â”‚   X7R                  â”‚
    â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                        â”‚
    â”‚                           â”‚                               â”‚
    â”‚                           â–¼                               â”‚
    â”‚                      +5V_USB                              â”‚
    â”‚                           â”‚                               â”‚
    â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
    â”‚         â”‚                 â”‚                 â”‚             â”‚
    â”‚         â–¼                 â–¼                 â–¼             â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚   â”‚ AP2112K   â”‚    â”‚ 74AHCT245 â”‚    â”‚ TERMINAIS â”‚        â”‚
    â”‚   â”‚  3.3V     â”‚    â”‚ (5V VCC)  â”‚    â”‚ PARAFUSO  â”‚        â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
    â”‚         â”‚                                  â”‚              â”‚
    â”‚         â–¼                                  â–¼              â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚   â”‚  ESP32    â”‚                      â”‚  PAINEL   â”‚        â”‚
    â”‚   â”‚  + RTC    â”‚                      â”‚   P10     â”‚        â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
    â”‚                                                           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Notas:
- ResistÃªncias 5.1kÎ© nos CC1/CC2 anunciam "sink 5V/3A"
- Para 5A seria necessÃ¡rio PD controller com negociaÃ§Ã£o
- Sem PD controller: limitado a 5V/3A (15W) mÃ¡ximo garantido

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2.4 AnÃ¡lise de Consumo vs Disponibilidade

```
AnÃ¡lise de PotÃªncia - Painel P10 32x16:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Componente        â”‚ TensÃ£o â”‚ Corrente â”‚ Notas
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ESP32 + perifÃ©ricosâ”‚ 3.3V   â”‚ 200mA    â”‚ WiFi ativo
  74AHCT245 (x2)    â”‚ 5V     â”‚ 20mA     â”‚ Level shifters
  Painel P10 25%    â”‚ 5V     â”‚ 0.5A     â”‚ Brilho reduzido
  Painel P10 50%    â”‚ 5V     â”‚ 1.0A     â”‚ Uso tÃ­pico
  Painel P10 75%    â”‚ 5V     â”‚ 1.5A     â”‚ Brilho alto
  Painel P10 100%   â”‚ 5V     â”‚ 2.0A     â”‚ Todos LEDs brancos
  Picos transitÃ³riosâ”‚ 5V     â”‚ atÃ© 4A   â”‚ MudanÃ§as bruscas

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  CenÃ¡rios de Uso:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  ğŸ“± 5V/3A (15W) - Carregador comum:
     â†’ ESP32: 0.2A + Painel 50%: 1.0A = 1.2A âœ“
     â†’ Margem confortÃ¡vel para uso tÃ­pico
     â†’ âš ï¸ Pode ter brown-outs em picos

  ğŸ”Œ 5V/5A (25W) - Fonte RPi5 oficial:
     â†’ Suporta todos os cenÃ¡rios
     â†’ Margem para picos
     â†’ âš ï¸ Fonte especÃ­fica necessÃ¡ria

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 3. EstratÃ©gia B: TensÃ£o Alta + Buck Converter

### 3.1 Conceito

Usar uma tensÃ£o USB-C mais alta (9V, 15V ou 20V) e converter para 5V internamente. Isto resolve o problema de disponibilidade de fontes e reduz perdas no cabo.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESTRATÃ‰GIA B: ALTA TENSÃƒO + BUCK                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚   â”‚            â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚  FONTE     â”‚      â”‚                      PCB                         â”‚ â”‚
â”‚   â”‚  USB-C PD  â”‚      â”‚                                                  â”‚ â”‚
â”‚   â”‚  45-65W    â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚   â”‚            â”œâ”€â”€â”€â”€â”€â”€â”¤â”€â–ºâ”‚ USB-C  â”‚â”€â–ºâ”‚  PD    â”‚â”€â–ºâ”‚ BUCK   â”‚â”€â–ºâ”‚TERMINALâ”‚ â”‚ â”‚
â”‚   â”‚  9V/3A     â”‚      â”‚  â”‚ Recept.â”‚  â”‚CONTROL.â”‚  â”‚5V/6A   â”‚  â”‚PARAFUSOâ”‚ â”‚ â”‚
â”‚   â”‚  15V/3A    â”‚      â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚   â”‚  20V/3A    â”‚      â”‚       â”‚           â”‚           â”‚          â”‚      â”‚ â”‚
â”‚   â”‚            â”‚      â”‚       â”‚           â”‚           â”‚          â”‚      â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚       â–¼           â”‚           â–¼          â–¼      â”‚ â”‚
â”‚                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚                       â”‚  â”‚ CH340C â”‚       â”‚     â”‚ +5V    â”‚  â”‚ PAINEL â”‚  â”‚ â”‚
â”‚                       â”‚  â”‚ USB-   â”‚       â”‚     â”‚ Rail   â”‚  â”‚  P10   â”‚  â”‚ â”‚
â”‚                       â”‚  â”‚ UART   â”‚       â”‚     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚                       â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜       â”‚         â”‚                   â”‚ â”‚
â”‚                       â”‚       â”‚           â”‚         â–¼                   â”‚ â”‚
â”‚                       â”‚       â”‚           â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚
â”‚                       â”‚       â”‚           â”‚   â”‚ AP2112K  â”‚              â”‚ â”‚
â”‚                       â”‚       â”‚           â”‚   â”‚  3.3V    â”‚              â”‚ â”‚
â”‚                       â”‚       â”‚           â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚                       â”‚       â”‚           â”‚        â”‚                    â”‚ â”‚
â”‚                       â”‚       â–¼           â”‚        â–¼                    â”‚ â”‚
â”‚                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚                       â”‚  â”‚            ESP32                â”‚            â”‚ â”‚
â”‚                       â”‚  â”‚         (3.3V logic)            â”‚            â”‚ â”‚
â”‚                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚                       â”‚                                                  â”‚ â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â”‚   Vantagens:                                                                â”‚
â”‚   âœ“ Fontes 45-65W USB-C sÃ£o MUITO comuns (laptops, tablets)                â”‚
â”‚   âœ“ Menor corrente no cabo = menores perdas (IÂ²R)                          â”‚
â”‚   âœ“ Buck converter fornece 5V estÃ¡vel com alta eficiÃªncia (>90%)           â”‚
â”‚   âœ“ Maior margem para picos de corrente                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Vantagens da TensÃ£o Alta

```
AnÃ¡lise de Perdas no Cabo USB-C:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Para fornecer 25W ao painel (5V Ã— 5A):

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ TensÃ£o Entrada â”‚ Corrente  â”‚ Perda Caboâ”‚ Notas             â”‚
  â”‚                â”‚           â”‚ (0.1Î©)    â”‚                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 5V             â”‚ 5.0A      â”‚ 2.5W      â”‚ Queda: 0.5V (10%)â”‚
  â”‚ 9V             â”‚ 2.8A      â”‚ 0.8W      â”‚ Queda: 0.3V (3%) â”‚
  â”‚ 15V            â”‚ 1.7A      â”‚ 0.3W      â”‚ Queda: 0.2V (1%) â”‚
  â”‚ 20V            â”‚ 1.3A      â”‚ 0.2W      â”‚ Queda: 0.1V (1%) â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Perda no cabo = IÂ² Ã— R_cabo

  ğŸ’¡ Usar 20V reduz perdas no cabo em 12x!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Disponibilidade de Fontes USB-C PD:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                   DISPONIBILIDADE                           â”‚
  â”‚                                                             â”‚
  â”‚  5V/5A (25W)  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  ~10% das fontes     â”‚
  â”‚                                                             â”‚
  â”‚  9V/3A (27W)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  ~50% das fontes     â”‚
  â”‚                                                             â”‚
  â”‚  15V/3A (45W) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  ~70% das fontes     â”‚
  â”‚                                                             â”‚
  â”‚  20V/3A (60W) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  ~85% das fontes     â”‚
  â”‚                                                             â”‚
  â”‚  20V/5A (100W)â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ~95% das fontes     â”‚
  â”‚                      (para laptops)                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âœ“ Fontes de laptop (Dell, Lenovo, Apple) fornecem 20V/3A
  âœ“ Carregadores GaN modernos suportam mÃºltiplas tensÃµes
  âœ“ Praticamente qualquer fonte PD 45W+ funciona

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.3 OpÃ§Ãµes de PD Controller

```
ComparaÃ§Ã£o de PD Controllers:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                 â”‚ CYPD3177            â”‚ FUSB302B           â”‚
  â”‚                 â”‚ (Infineon/Cypress)  â”‚ (onsemi)           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Tipo            â”‚ Sink-only           â”‚ DRP/SRC/SNK        â”‚
  â”‚ ConfiguraÃ§Ã£o    â”‚ Hardware (pins)     â”‚ Software (I2C)     â”‚
  â”‚ TensÃµes         â”‚ 5V, 9V, 12V, 20V    â”‚ Qualquer PD        â”‚
  â”‚ Correntes       â”‚ 1A, 2A, 3A, 5A      â”‚ ConfigurÃ¡vel       â”‚
  â”‚ Complexidade    â”‚ Baixa (sem firmware)â”‚ Alta (precisa MCU) â”‚
  â”‚ Package         â”‚ 24-QFN              â”‚ 14-WLCSP           â”‚
  â”‚ PreÃ§o           â”‚ ~â‚¬1.50              â”‚ ~â‚¬1.00             â”‚
  â”‚ LCSC            â”‚ C2678129            â”‚ C2828408           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ“Œ RecomendaÃ§Ã£o: CYPD3177 para simplicidade (nÃ£o precisa firmware)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Alternativa EconÃ³mica: IP2721
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  O IP2721 Ã© uma soluÃ§Ã£o mais simples e barata:
  - Suporta PD 3.0
  - ConfiguraÃ§Ã£o por resistor
  - TensÃµes: 5V, 9V, 12V, 15V, 20V
  - Package: DFN-10
  - PreÃ§o: ~â‚¬0.30

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                   IP2721 Pinout                          â”‚
  â”‚                                                          â”‚
  â”‚   VBUS â”€â”€â”¬â”€â”€ [IP2721] â”€â”€â”¬â”€â”€ VOUT (Ã  tensÃ£o selecionada) â”‚
  â”‚          â”‚              â”‚                                â”‚
  â”‚   CC1 â”€â”€â”€â”¤              â”œâ”€â”€ SET (resistor seletor)      â”‚
  â”‚   CC2 â”€â”€â”€â”¤              â”‚                                â”‚
  â”‚          â”‚              â”‚                                â”‚
  â”‚   GND â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€ GND                         â”‚
  â”‚                                                          â”‚
  â”‚   Resistor SET:                                          â”‚
  â”‚   - 0Î©    â†’ 20V                                         â”‚
  â”‚   - 10kÎ©  â†’ 15V                                         â”‚
  â”‚   - 20kÎ©  â†’ 12V                                         â”‚
  â”‚   - 33kÎ©  â†’ 9V                                          â”‚
  â”‚   - 56kÎ©  â†’ 5V                                          â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.4 Buck Converter para 5V

```
OpÃ§Ãµes de Buck Converter:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Componente      â”‚ Corrente    â”‚ Vin      â”‚ EficiÃªncia     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ MP2359          â”‚ 1.2A        â”‚ 4.5-24V  â”‚ 92%            â”‚
  â”‚ MP1584          â”‚ 3A          â”‚ 4.5-28V  â”‚ 92%            â”‚
  â”‚ TPS54531        â”‚ 5A          â”‚ 3.5-28V  â”‚ 93%            â”‚
  â”‚ MP4560          â”‚ 2A          â”‚ 4.5-55V  â”‚ 90%            â”‚
  â”‚ XL4015          â”‚ 5A          â”‚ 8-36V    â”‚ 90%            â”‚
  â”‚ LM2596          â”‚ 3A          â”‚ 4.5-40V  â”‚ 85%            â”‚
  â”‚ TPS5430         â”‚ 3A          â”‚ 5.5-36V  â”‚ 90%            â”‚
  â”‚ SY8303          â”‚ 3A          â”‚ 4.5-30V  â”‚ 93%            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ“Œ RecomendaÃ§Ã£o: MP1584EN (mÃ³dulo) ou TPS54531 (IC)
     - MP1584EN: MÃ³dulo prÃ©-montado, â‚¬0.80, fÃ¡cil de usar
     - TPS54531: IC, â‚¬0.60, requer design de PCB

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Circuito TÃ­pico MP1584EN:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                  Vin (9-20V do PD Controller)
                         â”‚
                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                    â”‚                    â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚   â”‚           MP1584EN              â”‚   â”‚
    â”‚   â”‚                                 â”‚   â”‚
    â”‚   â”‚  IN+      â”Œâ”€â”€â”€â”€â”      OUT+      â”‚   â”‚
    â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â–º +5V (6A max)
    â”‚   â”‚           â”‚ FB â”‚                â”‚   â”‚
    â”‚   â”‚  IN-      â”‚    â”‚      OUT-      â”‚   â”‚
    â”‚   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â–º GND
    â”‚   â”‚           â””â”€â”€â”€â”€â”˜                â”‚   â”‚
    â”‚   â”‚                                 â”‚   â”‚
    â”‚   â”‚    [Ajuste: PotenciÃ³metro       â”‚   â”‚
    â”‚   â”‚     ou resistor para 5.0V]      â”‚   â”‚
    â”‚   â”‚                                 â”‚   â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                                         â”‚
    â”‚   Cin: 100ÂµF 25V eletrolÃ­tico           â”‚
    â”‚   Cout: 220ÂµF 10V eletrolÃ­tico          â”‚
    â”‚                                         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  EspecificaÃ§Ãµes MP1584EN:
  - Entrada: 4.5V - 28V
  - SaÃ­da: 0.8V - 25V (ajustÃ¡vel)
  - Corrente: 3A contÃ­nua, 4A pico
  - EficiÃªncia: ~92% @ 5V/3A
  - FrequÃªncia: 1.5MHz (indutor pequeno)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.5 Diagrama Completo - EstratÃ©gia B

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ESTRATÃ‰GIA B: CIRCUITO COMPLETO                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                        USB-C Receptacle                                     â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚   VBUS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ VBUS (5-20V)    â”‚                                   â”‚
â”‚                       â”‚                 â”‚                                   â”‚
â”‚   GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ GND             â”‚                                   â”‚
â”‚                       â”‚                 â”‚                                   â”‚
â”‚   D+ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ D+              â”‚â”€â”€â”€â–º CH340C (USB dados)            â”‚
â”‚   D- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ D-              â”‚â”€â”€â”€â–º CH340C (USB dados)            â”‚
â”‚                       â”‚                 â”‚                                   â”‚
â”‚   CC1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ CC1             â”‚â”€â”€â”€â”                               â”‚
â”‚   CC2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ CC2             â”‚â”€â”€â”€â”¤                               â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                               â”‚
â”‚                              â”‚              â”‚                               â”‚
â”‚                              â”‚              â”‚                               â”‚
â”‚                              â–¼              â–¼                               â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                       â”‚        IP2721 / CYPD3177    â”‚                       â”‚
â”‚                       â”‚        PD Controller        â”‚                       â”‚
â”‚                       â”‚                             â”‚                       â”‚
â”‚                       â”‚  SET: [20kÎ©] â†’ 12V output   â”‚                       â”‚
â”‚                       â”‚       [0Î©]   â†’ 20V output   â”‚                       â”‚
â”‚                       â”‚                             â”‚                       â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                      â”‚                                      â”‚
â”‚                              VOUT = 9V/12V/15V/20V                          â”‚
â”‚                                      â”‚                                      â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                       â”‚                             â”‚                       â”‚
â”‚                      â•â•§â• C1                         â”‚                       â”‚
â”‚                  100ÂµF 35V                          â”‚                       â”‚
â”‚                       â”‚                             â”‚                       â”‚
â”‚                       â”‚                             â–¼                       â”‚
â”‚                       â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                       â”‚      â”‚         BUCK CONVERTER             â”‚         â”‚
â”‚                       â”‚      â”‚         (MP1584EN / TPS54531)      â”‚         â”‚
â”‚                       â”‚      â”‚                                    â”‚         â”‚
â”‚                       â””â”€â”€â”€â”€â”€â–ºâ”‚  VIN                        VOUT   â”‚â”€â”€â”¬â”€â–º +5Vâ”‚
â”‚                              â”‚                                    â”‚  â”‚      â”‚
â”‚                              â”‚  GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GND   â”‚  â”‚      â”‚
â”‚                              â”‚                                    â”‚  â”‚      â”‚
â”‚                              â”‚  FB â†â”€â”€ [Voltage divider: 5.0V]   â”‚  â”‚      â”‚
â”‚                              â”‚                                    â”‚  â”‚      â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚
â”‚                                                                      â”‚      â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                    â”‚                                                        â”‚
â”‚                    â”‚         +5V RAIL (5A disponÃ­vel)                       â”‚
â”‚                    â”‚                                                        â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚         â”‚          â”‚                  â”‚                  â”‚                  â”‚
â”‚        â•â•§â• C2      â”‚                  â”‚                  â”‚                  â”‚
â”‚    470ÂµF 10V       â”‚                  â”‚                  â”‚                  â”‚
â”‚         â”‚          â”‚                  â”‚                  â”‚                  â”‚
â”‚         â”‚          â–¼                  â–¼                  â–¼                  â”‚
â”‚         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚         â”‚   â”‚  AP2112K   â”‚    â”‚  74AHCT245 â”‚    â”‚   TERMINAIS    â”‚          â”‚
â”‚         â”‚   â”‚   3.3V     â”‚    â”‚   (x2)     â”‚    â”‚   PARAFUSO     â”‚          â”‚
â”‚         â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚          â”‚                                     â”‚                  â”‚
â”‚         â”‚          â–¼                                     â–¼                  â”‚
â”‚         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚         â”‚   â”‚   ESP32    â”‚                        â”‚   PAINEL   â”‚            â”‚
â”‚         â”‚   â”‚   + RTC    â”‚                        â”‚    P10     â”‚            â”‚
â”‚         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Componentes:
- U1: IP2721 ou CYPD3177 (PD Controller)
- U2: MP1584EN mÃ³dulo ou TPS54531 (Buck 5V/5A)
- C1: 100ÂµF 35V electrolÃ­tico (entrada buck)
- C2: 470ÂµF 10V electrolÃ­tico (saÃ­da buck / bulk capacitor)
- C3: 100ÂµF cerÃ¢mico 10V (saÃ­da buck, baixo ESR)

```

---

## 4. Workarounds para LimitaÃ§Ãµes de Corrente

### 4.1 Software: Limite de Brilho

O [Adafruit Matrix Portal S3](https://learn.adafruit.com/adafruit-matrixportal-s3/usb-power) recomenda limitar o brilho por software quando alimentado por USB.

```cpp
// Limite de brilho por software (ESP32 + HUB75 library)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#include <ESP32-HUB75-MatrixPanel-I2S-DMA.h>

MatrixPanel_I2S_DMA *display = nullptr;

// ConfiguraÃ§Ã£o com brilho limitado
void setupDisplay() {
    HUB75_I2S_CFG mxconfig(
        32,     // largura
        16,     // altura
        1       // chain length
    );

    display = new MatrixPanel_I2S_DMA(mxconfig);
    display->begin();

    // CRÃTICO: Limitar brilho para reduzir consumo
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    //
    // Brilho 255 (100%): ~2A @ 5V (todos LEDs brancos)
    // Brilho 128 (50%):  ~1A @ 5V
    // Brilho 64 (25%):   ~0.5A @ 5V
    // Brilho 32 (12.5%): ~0.25A @ 5V
    //
    display->setBrightness8(64);  // 25% - Seguro para USB 5V/3A
}

// Brilho dinÃ¢mico baseado no conteÃºdo
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Se mostrar muitos pixels brancos, reduzir brilho
// Se mostrar poucos pixels, permitir brilho maior

uint8_t calculateSafeBrightness(uint16_t activePixels, uint16_t maxPixels) {
    // activePixels: nÃºmero de pixels acesos
    // maxPixels: total de pixels (32 Ã— 16 = 512)

    float fillRatio = (float)activePixels / maxPixels;

    // FÃ³rmula: menos pixels = mais brilho permitido
    // Corrente mÃ¡xima: 2.5A (para fonte 3A com margem)
    //
    // Se 100% pixels: brilho max 30%
    // Se 50% pixels:  brilho max 50%
    // Se 25% pixels:  brilho max 80%
    // Se 10% pixels:  brilho max 100%

    if (fillRatio > 0.8) return 64;      // 25%
    if (fillRatio > 0.5) return 96;      // 37%
    if (fillRatio > 0.25) return 128;    // 50%
    if (fillRatio > 0.1) return 192;     // 75%
    return 255;                           // 100%
}

// Perfis de consumo predefinidos
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
enum PowerProfile {
    POWER_USB_3A,    // USB 5V/3A (15W) - brilho mÃ¡x 25%
    POWER_USB_5A,    // USB 5V/5A (25W) - brilho mÃ¡x 75%
    POWER_FULL       // Fonte dedicada  - brilho mÃ¡x 100%
};

void setPowerProfile(PowerProfile profile) {
    switch (profile) {
        case POWER_USB_3A:
            display->setBrightness8(64);   // 25%
            break;
        case POWER_USB_5A:
            display->setBrightness8(192);  // 75%
            break;
        case POWER_FULL:
            display->setBrightness8(255);  // 100%
            break;
    }
}
```

### 4.2 Hardware: Bulk Capacitors

Condensadores de grande capacidade absorvem picos transitÃ³rios de corrente.

```
Dimensionamento de Bulk Capacitors:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  CenÃ¡rio: MudanÃ§a de padrÃ£o no painel causa pico de 2A por 10ms

  FÃ³rmula: C = I Ã— Î”t / Î”V

  - I = 2A (corrente de pico adicional)
  - Î”t = 10ms (duraÃ§Ã£o do pico)
  - Î”V = 0.3V (queda mÃ¡xima aceitÃ¡vel: 5V â†’ 4.7V)

  C = 2 Ã— 0.01 / 0.3 = 67mF â‰ˆ 68,000ÂµF!  â† ImpraticÃ¡vel

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Abordagem PrÃ¡tica:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Usar combinaÃ§Ã£o de condensadores com diferentes funÃ§Ãµes:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                             â”‚
  â”‚  +5V â”€â”€â”¬â”€â”€ [470ÂµF] â”€â”€â”¬â”€â”€ [100ÂµF] â”€â”€â”¬â”€â”€ [10ÂµF] â”€â”€â”¬â”€â”€ Load   â”‚
  â”‚        â”‚  16V Elec.  â”‚  Ceramic    â”‚  Ceramic   â”‚          â”‚
  â”‚        â”‚  ESR ~0.1Î©  â”‚  ESR ~5mÎ©   â”‚  ESR ~2mÎ©  â”‚          â”‚
  â”‚        â”‚             â”‚             â”‚            â”‚          â”‚
  â”‚       GND           GND           GND          GND         â”‚
  â”‚                                                             â”‚
  â”‚  470ÂµF: Energia para picos longos (>1ms)                   â”‚
  â”‚  100ÂµF cerÃ¢mico: Picos mÃ©dios, baixo ESR                   â”‚
  â”‚  10ÂµF cerÃ¢mico: RuÃ­do alta frequÃªncia                      â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Alternativa: Super-capacitor 1F 5.5V
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - Capacidade: 1F (1,000,000ÂµF!)
  - ESR: ~0.1Î©
  - PreÃ§o: ~â‚¬2
  - Tamanho: Î¦19mm Ã— H18mm

  Pode manter 5V durante vÃ¡rios segundos de alta corrente.
  âš ï¸ Cuidado: Inrush current elevado no arranque!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Esquema com Super-capacitor:
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  +5V_USB â”€â”€â”€[F1 PTC]â”€â”€â”€â”¬â”€â”€â”€[D1 Schottky]â”€â”€â”€â”¬â”€â”€â”€ +5V_CAP
                        â”‚                    â”‚
                       â•â•§â•                  â•â•§â•
                   C1 100ÂµF             SC1 1F/5.5V
                    16V                 (supercap)
                        â”‚                    â”‚
  GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€ GND

  Notas:
  - D1 (1N5819): Previne descarga do supercap para USB
  - F1 (PTC 3A): Limita inrush current
  - SC1 carrega lentamente (~30s para carga completa)
  - Fornece energia extra durante picos

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 4.3 Hardware: Current Limiting com Soft-Start

```
Circuito de Inrush Current Limit:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Problema: Ao ligar, condensadores grandes causam pico de corrente
            que pode disparar proteÃ§Ãµes da fonte USB.

  SoluÃ§Ã£o: Resistor + MOSFET para soft-start

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                               â”‚
  â”‚  +5V_USB â”€â”€â”¬â”€â”€â”€[R1 10Î©]â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º +5V_LOAD â”‚
  â”‚            â”‚               â”‚                                  â”‚
  â”‚            â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                           â”‚
  â”‚            â”‚        â”‚   Q1 P-FET  â”‚                           â”‚
  â”‚            â”‚        â”‚  (Si2301)   â”‚                           â”‚
  â”‚            â”‚        â”‚   S     D   â”‚                           â”‚
  â”‚            â”‚        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                           â”‚
  â”‚            â”‚               â”‚                                  â”‚
  â”‚            â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
  â”‚            â”‚     â”‚                                            â”‚
  â”‚            â”‚     â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
  â”‚            â”‚     â”‚   â”‚   Timer     â”‚                          â”‚
  â”‚            â”‚     â””â”€â”€â”€â”¤   555 ou    â”‚                          â”‚
  â”‚            â”‚         â”‚   RC delay  â”‚                          â”‚
  â”‚            â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                          â”‚
  â”‚            â”‚                â”‚                                 â”‚
  â”‚  GND â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º GND   â”‚
  â”‚                                                               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  SequÃªncia:
  1. t=0: Fonte liga, corrente passa por R1 (limitada a 0.5A)
  2. t=100ms: Timer activa Q1, MOSFET bypassa R1
  3. t>100ms: Corrente fluÃ­ livremente pelo MOSFET

  Alternativa simples: NTC Thermistor
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  +5V_USB â”€â”€[NTC 10Î©@25Â°C]â”€â”€â”€â–º +5V_LOAD

  - Frio: alta resistÃªncia, limita corrente
  - Aquece: baixa resistÃªncia, operaÃ§Ã£o normal
  - Custo: â‚¬0.10
  - Desvantagem: nÃ£o recupera instantaneamente apÃ³s desligar

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 5. Terminais de Parafuso

### 5.1 Design Estilo Matrix Portal S3

O [Adafruit Matrix Portal S3](https://www.adafruit.com/product/5778) usa terminais de parafuso para ligar os 5V diretamente ao painel LED.

```
Layout dos Terminais:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                             â”‚
  â”‚     SCREW TERMINAL BLOCK (2-pin, 5mm pitch)                â”‚
  â”‚                                                             â”‚
  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚     â”‚                                                 â”‚    â”‚
  â”‚     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
  â”‚     â”‚    â”‚   (+)   â”‚         â”‚   (-)   â”‚             â”‚    â”‚
  â”‚     â”‚    â”‚  +5V    â”‚         â”‚   GND   â”‚             â”‚    â”‚
  â”‚     â”‚    â”‚         â”‚         â”‚         â”‚             â”‚    â”‚
  â”‚     â”‚    â”‚  â”Œâ”€â”€â”€â”  â”‚         â”‚  â”Œâ”€â”€â”€â”  â”‚             â”‚    â”‚
  â”‚     â”‚    â”‚  â”‚ â—‰ â”‚  â”‚         â”‚  â”‚ â—‰ â”‚  â”‚ â† Parafusosâ”‚    â”‚
  â”‚     â”‚    â”‚  â””â”€â”€â”€â”˜  â”‚         â”‚  â””â”€â”€â”€â”˜  â”‚             â”‚    â”‚
  â”‚     â”‚    â”‚         â”‚         â”‚         â”‚             â”‚    â”‚
  â”‚     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
  â”‚     â”‚                                                 â”‚    â”‚
  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                             â”‚
  â”‚     EspecificaÃ§Ãµes:                                         â”‚
  â”‚     - Pitch: 5.0mm ou 5.08mm (0.2")                        â”‚
  â”‚     - Corrente: 10A+ rated                                  â”‚
  â”‚     - Fio: 12-22 AWG                                        â”‚
  â”‚     - Tipo: Spring-cage ou screw-clamp                      â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Componentes Recomendados:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Componente          â”‚ Specs          â”‚ PreÃ§o    â”‚ LCSC     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ KF301-5.0-2P        â”‚ 5mm 2-pin 10A  â”‚ â‚¬0.10    â”‚ C430646  â”‚
  â”‚ Phoenix 1935161     â”‚ 5.08mm 2-pin   â”‚ â‚¬0.50    â”‚ Premium  â”‚
  â”‚ Wago 236-402        â”‚ Cage clamp     â”‚ â‚¬0.60    â”‚ Premium  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  LigaÃ§Ã£o ao Painel P10:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                    PCB
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                      â”‚
  â”‚  USB-C â”€â”€â–º [Circuito] â”€â”€â–º +5V â”€â”€â”¬â”€â–º [TERMINAL +]    â”‚
  â”‚                                 â”‚                    â”‚
  â”‚                          GND â”€â”€â”€â”´â”€â–º [TERMINAL -]    â”‚
  â”‚                                                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚ Fios 16-18 AWG
                                          â”‚
                                          â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚    PAINEL P10       â”‚
                               â”‚                     â”‚
                               â”‚  VCC+ â”€â”€â”€â”€ VCC-     â”‚
                               â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš ï¸ IMPORTANTE:
  - Usar fio de pelo menos 18 AWG (0.82mmÂ²) para 3A+
  - Manter cabos curtos (<30cm) para minimizar perdas
  - Verificar polaridade antes de ligar!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 5.2 ProteÃ§Ã£o contra LigaÃ§Ã£o Inversa nos Terminais

```
ProteÃ§Ã£o nos Terminais de Parafuso:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âš ï¸ Utilizadores podem ligar fios invertidos!

  SoluÃ§Ã£o: P-MOSFET ou dÃ­odo Schottky

  +5V_INTERNO â”€â”€â”¬â”€â”€[Q1 Si2301]â”€â”€â”¬â”€â”€[TERMINAL +]
                â”‚    P-MOSFET   â”‚
                â”‚               â”‚
               â”€â”´â”€ D1          â•â•§â• C1
            Body diode         100ÂµF
                â”‚               â”‚
  GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€[TERMINAL -]

  Funcionamento:
  - Polaridade correcta: MOSFET conduz (baixa perda)
  - Polaridade invertida: MOSFET bloqueia, body diode tambÃ©m
  - Protege todo o circuito interno

  Alternativa mais simples (com perda):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  +5V_INTERNO â”€â”€[D1 SS54 Schottky]â”€â”€[TERMINAL +]

  Perda: 0.3V Ã— 3A = 0.9W (aceitÃ¡vel)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 5.3 LEDs Indicadores de Power (Inspirado no MatrixPortal S3)

O [Adafruit Matrix Portal S3](https://github.com/adafruit/Adafruit-MatrixPortal-S3-PCB) inclui LEDs indicadores para diagnÃ³stico visual do estado de alimentaÃ§Ã£o. Esta Ã© uma boa prÃ¡tica que facilita a resoluÃ§Ã£o de problemas.

```
LEDs de IndicaÃ§Ã£o de Power:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                             â”‚
  â”‚  +5V â”€â”€â”€â”€[R1 1kÎ©]â”€â”€â”€â”€â”¬â”€â”€â”€â”€[LED Verde]â”€â”€â”€â”€â–º GND             â”‚
  â”‚                      â”‚                                      â”‚
  â”‚                      â””â”€â”€ Indica: 5V presente               â”‚
  â”‚                                                             â”‚
  â”‚  3.3V â”€â”€â”€[R2 1kÎ©]â”€â”€â”€â”€â”¬â”€â”€â”€â”€[LED Verde]â”€â”€â”€â”€â–º GND             â”‚
  â”‚                      â”‚                                      â”‚
  â”‚                      â””â”€â”€ Indica: Regulador 3.3V OK         â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  EspecificaÃ§Ãµes:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - LED: Verde 0603 ou 0805 (~2V forward, 5-10mA)
  - R1: 1kÎ© para 5V â†’ (5V - 2V) / 1kÎ© = 3mA
  - R2: 1kÎ© para 3.3V â†’ (3.3V - 2V) / 1kÎ© = 1.3mA

  Vantagens:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ“ DiagnÃ³stico visual imediato
  âœ“ Confirma que ambos os rails estÃ£o activos
  âœ“ Baixo consumo (~4mA total)
  âœ“ Ãštil para debugging durante desenvolvimento

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 6. ComparaÃ§Ã£o das EstratÃ©gias

```
Tabela Comparativa:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CaracterÃ­stica      â”‚ ESTRATÃ‰GIA A            â”‚ ESTRATÃ‰GIA B            â”‚
  â”‚                     â”‚ (5V Direto)             â”‚ (Alta TensÃ£o + Buck)    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Complexidade PCB    â”‚ â­ BAIXA                â”‚ â­â­ MÃ‰DIA               â”‚
  â”‚                     â”‚ Apenas proteÃ§Ãµes        â”‚ PD controller + buck    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Custo componentes   â”‚ â‚¬1.50                   â”‚ â‚¬4.00                   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Compatibilidade     â”‚ âš ï¸ LIMITADA            â”‚ â­â­â­ EXCELENTE        â”‚
  â”‚ de fontes           â”‚ Precisa 5V/5A ou 5V/3A  â”‚ Qualquer PD 45W+        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Corrente disponÃ­vel â”‚ 3A (tÃ­pico)             â”‚ 5-6A                    â”‚
  â”‚                     â”‚ 5A (fonte especial)     â”‚                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Perdas no cabo      â”‚ âš ï¸ ALTAS               â”‚ â­ BAIXAS               â”‚
  â”‚                     â”‚ IÂ²R @ 5A = 2.5W         â”‚ IÂ²R @ 2A = 0.4W         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ EficiÃªncia total    â”‚ ~95%                    â”‚ ~90% (inclui buck)      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Brilho mÃ¡ximo       â”‚ 25-50% (USB 3A)         â”‚ 100%                    â”‚
  â”‚ recomendado         â”‚ 75% (USB 5A)            â”‚                         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Estabilidade        â”‚ âš ï¸ Depende da fonte    â”‚ â­â­â­ Excelente        â”‚
  â”‚                     â”‚ e do cabo               â”‚ Buck regula             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ RuÃ­do/ripple        â”‚ Depende da fonte        â”‚ â­ Baixo (buck filtra)  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ SeguranÃ§a           â”‚ â­â­ Boa                â”‚ â­â­â­ Melhor           â”‚
  â”‚                     â”‚ SÃ³ 5V expostos          â”‚ 5V isolados pelo buck   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ“Œ RECOMENDAÃ‡ÃƒO:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                                         â”‚
  â”‚  Para PROTOTIPAGEM RÃPIDA:                                              â”‚
  â”‚  â†’ EstratÃ©gia A (5V direto) com limite de brilho                       â”‚
  â”‚  â†’ Usar fonte USB-C 5V/3A comum                                        â”‚
  â”‚  â†’ Brilho mÃ¡ximo 40-50%                                                â”‚
  â”‚                                                                         â”‚
  â”‚  Para PRODUTO FINAL:                                                    â”‚
  â”‚  â†’ EstratÃ©gia B (Alta tensÃ£o + buck)                                   â”‚
  â”‚  â†’ CompatÃ­vel com qualquer carregador laptop/tablet                    â”‚
  â”‚  â†’ Brilho 100% sem restriÃ§Ãµes                                          â”‚
  â”‚  â†’ Mais robusto e profissional                                         â”‚
  â”‚                                                                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 7. Bill of Materials (BOM)

### 7.1 EstratÃ©gia A: 5V Direto

| Ref | Componente | EspecificaÃ§Ã£o | Package | Qty | PreÃ§o | LCSC |
|-----|------------|---------------|---------|-----|-------|------|
| J1 | USB-C Receptacle | 16-pin, USB 2.0 | SMD | 1 | â‚¬0.40 | C165948 |
| R1, R2 | Resistor 5.1kÎ© | 1% 0.1W | 0402 | 2 | â‚¬0.01 | C25905 |
| F1 | PTC Fuse | 3A hold, 6A trip | 1812 | 1 | â‚¬0.15 | C369159 |
| D1 | TVS SMBJ5.0A | 5V 600W | SMB | 1 | â‚¬0.20 | C123799 |
| C1 | Capacitor | 470ÂµF 16V electrolÃ­tico | Î¦10mm | 1 | â‚¬0.15 | C134768 |
| C2 | Capacitor | 100ÂµF 10V cerÃ¢mico | 1206 | 1 | â‚¬0.30 | C408880 |
| C3 | Capacitor | 100nF 16V X7R | 0402 | 1 | â‚¬0.01 | C307331 |
| J2 | Screw Terminal | 2-pin 5.0mm 10A | THT | 1 | â‚¬0.10 | C430646 |
| **Total** | | | | | **â‚¬1.32** | |

### 7.2 EstratÃ©gia B: Alta TensÃ£o + Buck

| Ref | Componente | EspecificaÃ§Ã£o | Package | Qty | PreÃ§o | LCSC |
|-----|------------|---------------|---------|-----|-------|------|
| J1 | USB-C Receptacle | 16-pin, USB 2.0 | SMD | 1 | â‚¬0.40 | C165948 |
| U1 | IP2721 | PD Controller 5-20V | DFN-10 | 1 | â‚¬0.35 | C2889848 |
| R_SET | Resistor | Ver tabela tensÃ£o | 0402 | 1 | â‚¬0.01 | - |
| U2 | MP1584EN | Buck 3A module | Module | 1 | â‚¬0.80 | MÃ³dulo |
| ou | TPS54531 | Buck 5A IC | HTSSOP-14 | 1 | â‚¬0.60 | C130162 |
| L1 | Indutor | 22ÂµH 5A (se TPS54531) | 10x10mm | 1 | â‚¬0.30 | C339828 |
| D2 | Schottky | SS54 5A (se TPS54531) | SMC | 1 | â‚¬0.10 | C123806 |
| F1 | PTC Fuse | 3A hold | 1812 | 1 | â‚¬0.15 | C369159 |
| D1 | TVS SMBJ24A | 24V (entrada) | SMB | 1 | â‚¬0.25 | C114152 |
| C1 | Capacitor | 100ÂµF 35V electrolÃ­tico | Î¦8mm | 1 | â‚¬0.15 | C249490 |
| C2 | Capacitor | 470ÂµF 10V electrolÃ­tico | Î¦10mm | 1 | â‚¬0.15 | C134768 |
| C3 | Capacitor | 100ÂµF 10V cerÃ¢mico | 1206 | 1 | â‚¬0.30 | C408880 |
| C4 | Capacitor | 22ÂµF 35V (entrada buck) | 1206 | 2 | â‚¬0.10 | C159770 |
| J2 | Screw Terminal | 2-pin 5.0mm 10A | THT | 1 | â‚¬0.10 | C430646 |
| **Total (mÃ³dulo)** | | | | | **â‚¬2.95** | |
| **Total (IC)** | | | | | **â‚¬3.00** | |

### 7.3 Regulador 3.3V e LEDs (Comum a ambas estratÃ©gias)

| Ref | Componente | EspecificaÃ§Ã£o | Package | Qty | PreÃ§o | LCSC |
|-----|------------|---------------|---------|-----|-------|------|
| U_REG | AP2112K-3.3 | LDO 3.3V 600mA | SOT-23-5 | 1 | â‚¬0.15 | C51118 |
| C_IN | Capacitor | 10ÂµF 10V X5R | 0603 | 1 | â‚¬0.02 | C19702 |
| C_OUT | Capacitor | 10ÂµF 10V X5R | 0603 | 1 | â‚¬0.02 | C19702 |
| LED1 | LED Verde | 0805 ~2V 20mA | 0805 | 1 | â‚¬0.02 | C2297 |
| LED2 | LED Verde | 0805 ~2V 20mA | 0805 | 1 | â‚¬0.02 | C2297 |
| R_LED1 | Resistor | 1kÎ© 1% | 0402 | 1 | â‚¬0.01 | C11702 |
| R_LED2 | Resistor | 1kÎ© 1% | 0402 | 1 | â‚¬0.01 | C11702 |
| **Total** | | | | | **â‚¬0.25** | |

> **Nota:** O AP2112K-3.3 foi escolhido em vez do AMS1117 por ter:
> - Menor dropout (0.4V vs 1.0V)
> - Pino de enable para soft-start
> - Package mais compacto (SOT-23-5)
> - Usado no Adafruit MatrixPortal S3

### 7.4 Resistor SET para IP2721

| TensÃ£o Desejada | Resistor SET |
|-----------------|--------------|
| 20V | 0Î© (curto) |
| 15V | 10kÎ© |
| 12V | 20kÎ© |
| 9V | 33kÎ© |
| 5V | 56kÎ© |

---

## 8. Esquema de Blocos Final

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CIRCADIAN CLOCK v2.0 - USB-C POWER                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   FONTE     â”‚      â”‚                    PCB                         â”‚  â”‚
â”‚   â”‚   USB-C     â”‚      â”‚                                                â”‚  â”‚
â”‚   â”‚   PD        â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚   â”‚   45-65W    â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â–ºâ”‚ USB-C  â”‚â”€â”€â”€â–ºâ”‚ IP2721   â”‚â”€â”€â”€â–ºâ”‚ MP1584EN   â”‚ â”‚  â”‚
â”‚   â”‚             â”‚      â”‚  â”‚ Recept â”‚    â”‚ PD Ctrl  â”‚    â”‚ Buck 5V    â”‚ â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â”‚ (12V)    â”‚    â”‚            â”‚ â”‚  â”‚
â”‚                        â”‚       â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                        â”‚       â”‚                               â”‚       â”‚  â”‚
â”‚                        â”‚       â”‚                               â–¼       â”‚  â”‚
â”‚                        â”‚       â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚                        â”‚       â”‚                        â”‚  +5V     â”‚   â”‚  â”‚
â”‚                        â”‚       â”‚                        â”‚  RAIL    â”‚   â”‚  â”‚
â”‚                        â”‚       â”‚                        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚                        â”‚       â”‚                             â”‚         â”‚  â”‚
â”‚                        â”‚       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚                        â”‚       â”‚    â”‚                        â”‚       â”‚ â”‚  â”‚
â”‚                        â”‚       â–¼    â–¼                        â–¼       â–¼ â”‚  â”‚
â”‚                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚                        â”‚  â”‚ CH340C     â”‚  â”‚ AP2112K    â”‚  â”‚ SCREW     â”‚â”‚  â”‚
â”‚                        â”‚  â”‚ USB-UART   â”‚  â”‚ 3.3V       â”‚  â”‚ TERMINALS â”‚â”‚  â”‚
â”‚                        â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚                        â”‚        â”‚                â”‚              â”‚      â”‚  â”‚
â”‚                        â”‚        â”‚                â–¼              â”‚      â”‚  â”‚
â”‚                        â”‚        â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚      â”‚  â”‚
â”‚                        â”‚        â”‚     â”‚      ESP32       â”‚      â”‚      â”‚  â”‚
â”‚                        â”‚        â””â”€â”€â”€â”€â–ºâ”‚  (3.3V logic)    â”‚      â”‚      â”‚  â”‚
â”‚                        â”‚              â”‚                  â”‚      â”‚      â”‚  â”‚
â”‚                        â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚      â”‚  â”‚
â”‚                        â”‚              â”‚  â”‚ 74AHCT245  â”‚â—„â”€â”¼â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚                        â”‚              â”‚  â”‚ 3.3Vâ†’5V    â”‚  â”‚  5V VCC     â”‚  â”‚
â”‚                        â”‚              â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚             â”‚  â”‚
â”‚                        â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚                        â”‚                       â”‚                       â”‚  â”‚
â”‚                        â”‚                       â–¼                       â”‚  â”‚
â”‚                        â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â”‚
â”‚                        â”‚              â”‚    HUB75       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚                        â”‚              â”‚    HEADER      â”‚  Painel 5V    â”‚  â”‚
â”‚                        â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â”‚
â”‚                        â”‚                                               â”‚  â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                           â”‚
â”‚                                            â”‚                              â”‚
â”‚                                            â–¼                              â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                                    â”‚    PAINEL     â”‚                      â”‚
â”‚                                    â”‚     P10       â”‚                      â”‚
â”‚                                    â”‚   32x16 RGB   â”‚                      â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Fontes USB-C Recomendadas

### 9.1 Para EstratÃ©gia A (5V/5A Direto)

| Fonte | PotÃªncia | Perfis | PreÃ§o | Notas |
|-------|----------|--------|-------|-------|
| Raspberry Pi 5 Official | 27W | 5V/5A | ~â‚¬15 | EspecÃ­fica para 5V/5A |
| Mean Well GS25U05 USB-C | 25W | 5V/5A | ~â‚¬12 | Industrial, fiÃ¡vel |

### 9.2 Para EstratÃ©gia B (Alta TensÃ£o + Buck)

| Fonte | PotÃªncia | Perfis | PreÃ§o | Notas |
|-------|----------|--------|-------|-------|
| Anker 511 Nano 3 | 30W | 5V/3A, 9V/3A, 20V/1.5A | ~â‚¬18 | Compacto, GaN |
| Baseus 45W GaN | 45W | 5V/3A, 9V/3A, 15V/3A, 20V/2.25A | ~â‚¬15 | Bom custo-benefÃ­cio |
| Ugreen 65W | 65W | Todos os perfis PD | ~â‚¬25 | 2 portas |
| Apple 30W USB-C | 30W | 5V/3A, 9V/3A, 15V/2A, 20V/1.5A | ~â‚¬35 | Premium, fiÃ¡vel |
| **Carregador laptop USB-C** | 45-100W | Todos | IncluÃ­do | JÃ¡ disponÃ­vel! |

> **ğŸ’¡ Dica:** Muitos utilizadores jÃ¡ tÃªm carregadores USB-C de laptops que funcionam perfeitamente com a EstratÃ©gia B.

### 9.3 Cabo USB-C IncluÃ­do

O produto inclui um cabo USB-C na caixa. O carregador/transformador **nÃ£o estÃ¡ incluÃ­do** - o utilizador usa um carregador USB-C PD que jÃ¡ possui (laptop, tablet, etc.) ou adquire separadamente.

```
EspecificaÃ§Ãµes do Cabo USB-C:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Tipo:           USB-C para USB-C
  Comprimento:    1 metro (Â±5cm)
  PotÃªncia:       60W mÃ­nimo (20V/3A)
  Dados:          USB 2.0 (480Mbps) â† OBRIGATÃ“RIO!
  Cor:            Preto
  Conectores:     ReforÃ§ados/moldados

  âš ï¸ IMPORTANTE: O cabo DEVE suportar dados USB 2.0!
     Cabos "charging only" nÃ£o funcionam para programar o ESP32.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Porque NÃƒO precisa de cabo especial 5A (e-marked):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Com a EstratÃ©gia B (PD + Buck), a corrente no cabo Ã© baixa:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  PotÃªncia necessÃ¡ria: 25W (5V Ã— 5A no painel)              â”‚
  â”‚                                                            â”‚
  â”‚  Se PD negoceia 20V:  25W Ã· 20V = 1.25A  â† Cabo 3A OK!    â”‚
  â”‚  Se PD negoceia 15V:  25W Ã· 15V = 1.67A  â† Cabo 3A OK!    â”‚
  â”‚  Se PD negoceia 12V:  25W Ã· 12V = 2.08A  â† Cabo 3A OK!    â”‚
  â”‚  Se PD negoceia 9V:   25W Ã· 9V  = 2.78A  â† Cabo 3A OK!    â”‚
  â”‚                                                            â”‚
  â”‚  âœ“ Qualquer cabo USB-C 60W/3A standard Ã© suficiente       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Fornecedores sugeridos (bulk):**

| Fornecedor | PreÃ§o/unidade | MOQ | Entrega |
|------------|---------------|-----|---------|
| AliExpress (bulk) | â‚¬1.00-1.50 | 50+ | 2-4 semanas |
| Amazon Business | â‚¬3-5 | 10+ | 1-3 dias |

### 9.4 ConteÃºdo da Embalagem

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONTEÃšDO DA CAIXA                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  âœ… PCB Circadian Clock v2 (montado e testado)                 â”‚
â”‚  âœ… Painel LED P10 32x16 RGB                                   â”‚
â”‚  âœ… Cabo USB-C 1m (60W, com dados USB 2.0)                     â”‚
â”‚  âœ… Guia de inÃ­cio rÃ¡pido                                      â”‚
â”‚                                                                 â”‚
â”‚  âŒ Carregador USB-C (nÃ£o incluÃ­do)                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ“‹ Texto sugerido para embalagem/manual:

  "Requer carregador USB-C PD 45W ou superior (nÃ£o incluÃ­do).
   CompatÃ­vel com carregadores de laptops e tablets:
   MacBook, Dell, Lenovo, HP, Samsung, etc."

```

---

## 10. Firmware: DetecÃ§Ã£o AutomÃ¡tica de PotÃªncia

```cpp
// firmware/power_management.h
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#ifndef POWER_MANAGEMENT_H
#define POWER_MANAGEMENT_H

#include <Arduino.h>
#include <ESP32-HUB75-MatrixPanel-I2S-DMA.h>

// Pino ADC para medir tensÃ£o de entrada (com divisor)
#define VBUS_SENSE_PIN 36  // GPIO36 (ADC1_CH0)

// Divisor de tensÃ£o: 20V max â†’ 3.3V
// R1 = 100k, R2 = 22k â†’ Ratio = 22/(100+22) = 0.18
#define VOLTAGE_DIVIDER_RATIO 0.18

class PowerManager {
private:
    MatrixPanel_I2S_DMA *display;
    float inputVoltage;
    float maxBrightness;

public:
    PowerManager(MatrixPanel_I2S_DMA *dma_display) {
        display = dma_display;
        inputVoltage = 5.0;
        maxBrightness = 0.25;  // Conservador por defeito
    }

    // Medir tensÃ£o de entrada
    float measureInputVoltage() {
        int adcValue = analogRead(VBUS_SENSE_PIN);
        // ADC 12-bit: 0-4095 = 0-3.3V
        float adcVoltage = (adcValue / 4095.0) * 3.3;
        inputVoltage = adcVoltage / VOLTAGE_DIVIDER_RATIO;
        return inputVoltage;
    }

    // Determinar perfil de potÃªncia baseado na tensÃ£o
    void detectPowerProfile() {
        measureInputVoltage();

        Serial.printf("TensÃ£o de entrada: %.1fV\n", inputVoltage);

        if (inputVoltage >= 18.0) {
            // USB PD 20V â†’ Buck converter â†’ 5V estÃ¡vel
            Serial.println("Perfil: PD 20V (100% brilho disponÃ­vel)");
            maxBrightness = 1.0;  // 100%
        }
        else if (inputVoltage >= 14.0) {
            // USB PD 15V
            Serial.println("Perfil: PD 15V (100% brilho disponÃ­vel)");
            maxBrightness = 1.0;
        }
        else if (inputVoltage >= 11.0) {
            // USB PD 12V
            Serial.println("Perfil: PD 12V (100% brilho disponÃ­vel)");
            maxBrightness = 1.0;
        }
        else if (inputVoltage >= 8.0) {
            // USB PD 9V
            Serial.println("Perfil: PD 9V (100% brilho disponÃ­vel)");
            maxBrightness = 1.0;
        }
        else if (inputVoltage >= 4.5) {
            // USB 5V directo (sem buck)
            // Assumir 3A mÃ¡ximo (fonte tÃ­pica)
            Serial.println("Perfil: USB 5V direto (brilho limitado a 40%)");
            maxBrightness = 0.40;
        }
        else {
            Serial.println("AVISO: TensÃ£o baixa!");
            maxBrightness = 0.20;
        }

        applyBrightness();
    }

    void applyBrightness() {
        uint8_t brightness = (uint8_t)(maxBrightness * 255);
        display->setBrightness8(brightness);
        Serial.printf("Brilho aplicado: %d%%\n", (int)(maxBrightness * 100));
    }

    // Ajustar brilho baseado no conteÃºdo
    void adjustForContent(uint16_t activePixels, uint16_t totalPixels) {
        float fillRatio = (float)activePixels / totalPixels;

        // Se muitos pixels activos, reduzir brilho para evitar overcurrent
        float contentFactor = 1.0;
        if (fillRatio > 0.7) contentFactor = 0.6;
        else if (fillRatio > 0.5) contentFactor = 0.8;

        uint8_t brightness = (uint8_t)(maxBrightness * contentFactor * 255);
        display->setBrightness8(brightness);
    }

    float getMaxBrightness() { return maxBrightness; }
    float getInputVoltage() { return inputVoltage; }
};

#endif
```

---

## 11. ReferÃªncias

### DocumentaÃ§Ã£o Oficial
- [Adafruit Matrix Portal S3](https://www.adafruit.com/product/5778)
- [Adafruit Matrix Portal S3 - USB Power](https://learn.adafruit.com/adafruit-matrixportal-s3/usb-power)
- [Adafruit Matrix Portal S3 PCB (GitHub)](https://github.com/adafruit/Adafruit-MatrixPortal-S3-PCB)
- [Raspberry Pi 5 Power Requirements](https://circuitlabs.net/raspberry-pi-5-power-requirements-and-management/)

### FÃ³runs e DiscussÃµes
- [Raspberry Pi 5 5V/5A Power Issues](https://forums.raspberrypi.com/viewtopic.php?t=381080)
- [USB PD 5V/5A Availability Problem](https://forums.raspberrypi.com/viewtopic.php?t=357395)

### Componentes
- [CYPD3177 USB PD Sink Controller](https://hackaday.io/project/168762-usb-c-power-delivery-sink-cypd3177)
- [FUSB302B USB Type-C Controller](https://www.onsemi.com/products/interfaces/usb-type-c/fusb302b)
- [Cat-Sink USB-C PD Board](https://github.com/ElectronicCats/Cat-Sink)
- [AP2112K Datasheet (Diodes Inc)](https://www.diodes.com/assets/Datasheets/AP2112.pdf)

### AnÃ¡lise de Esquemas de ReferÃªncia
- **MatrixPortal S3 Schematic Analysis (Dez 2024)**: AnÃ¡lise do esquema Eagle confirmou:
  - Design usa 5V direto sem PD controller (apenas resistÃªncias 5.1kÎ© nos CC)
  - Regulador 3.3V: AP2112K-3.3 (600mA, low dropout)
  - Level shifters: 74AHCT245 (x2) para HUB75
  - LEDs indicadores de 5V e 3.3V para diagnÃ³stico
  - LimitaÃ§Ã£o: depende de fonte externa para correntes >3A

### USB Power Delivery
- [USB PD Specification Overview (Tom's Hardware)](https://www.tomshardware.com/peripherals/usb/the-usb-power-delivery-pd-specification-everything-you-need-to-know-about-usb-pd)
- [USB PD for General Purpose Use](https://www.electro-tech-online.com/threads/usb-c-pd-for-general-purpose-use.163644/)

---

*Documento criado: Dezembro 2024*
*VersÃ£o: 2.2 - USB-C Power Delivery*
*Atualizado: Dezembro 2024 - Cabo USB-C incluÃ­do, conteÃºdo da embalagem, anÃ¡lise MatrixPortal S3*

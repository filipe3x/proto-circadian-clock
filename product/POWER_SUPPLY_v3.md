# Power Supply v3 - USB-C PD 30W com Buck de Alta Corrente

Este documento descreve a arquitetura de alimentaÃ§Ã£o v3 baseada em USB-C Power Delivery, otimizada para 30W mÃ¡ximo com buck de alta corrente (8A).

---

## Changelog

| Data | VersÃ£o | AlteraÃ§Ãµes |
|------|--------|------------|
| Jan 2026 | 3.1 | **Corrigido valores feedback**: R_FB1=22kÎ©/R_FB2=3kÎ© (era 16.2kÎ©/3.01kÎ© - erro de cÃ¡lculo). Atualizado L1 LCSC para C2831487. Atualizadas referÃªncias para coincidir com KiCad: U10 (IP2721), U12 (SY8368), Q3 (MOSFET). |
| Jan 2025 | 3.0 | VersÃ£o inicial com IP2721 + SY8368AQQC |

---

## 1. VisÃ£o Geral

### 1.1 Filosofia de Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      POWER SUPPLY v2 vs v3                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   v2 (Anterior)                        v3 (Novo)                            â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•                        â•â•â•â•â•â•â•â•â•                            â”‚
â”‚                                                                             â”‚
â”‚   â€¢ Duas estratÃ©gias separadas         â€¢ Uma estratÃ©gia unificada           â”‚
â”‚     (5V direto OU PD+Buck)               (PD+Buck com fallback inteligente) â”‚
â”‚                                                                             â”‚
â”‚   â€¢ IP2721 ou CYPD3177                 â€¢ IP2721 + AO3400A MOSFET            â”‚
â”‚     (configuraÃ§Ã£o complexa)              (power-path controlado, 1 resistor) â”‚
â”‚                                                                             â”‚
â”‚   â€¢ MP1584EN (3A) ou TPS54531 (5A)     â€¢ SY8368AQQC (8A sÃ­ncrono)          â”‚
â”‚     (margem limitada)                    (folga para picos HUB75)           â”‚
â”‚                                                                             â”‚
â”‚   â€¢ 5V/5A ou tensÃ£o alta               â€¢ 15V preferido, 9V fallback         â”‚
â”‚     (dependia da fonte)                  (30W garantido na maioria)         â”‚
â”‚                                                                             â”‚
â”‚   â€¢ Brilho fixo ou manual              â€¢ Brilho automÃ¡tico baseado          â”‚
â”‚                                          na potÃªncia disponÃ­vel             â”‚
â”‚                                                                             â”‚
â”‚   Objectivo v3:                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚   âœ“ 30W mÃ¡ximo (15V @ 2A ou 9V @ 3A)                                       â”‚
â”‚   âœ“ Buck robusto com 8A de capacidade                                      â”‚
â”‚   âœ“ Fallback automÃ¡tico para fontes menores                                â”‚
â”‚   âœ“ "Funciona com quase tudo" - qualquer PD 27W+                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 EspecificaÃ§Ãµes Alvo

| ParÃ¢metro | MÃ­nimo | TÃ­pico | MÃ¡ximo | Notas |
|-----------|--------|--------|--------|-------|
| PotÃªncia entrada | 27W | 30W | 45W | USB-C PD |
| TensÃ£o entrada | 9V | 15V | 20V | PD negociado |
| TensÃ£o saÃ­da | 4.9V | 5.0V | 5.1V | Â±2% regulaÃ§Ã£o |
| Corrente saÃ­da | - | 5A | 8A | Picos HUB75 |
| EficiÃªncia | 90% | 93% | - | @ 15Vâ†’5V, 3A |

### 1.3 Perfis de PotÃªncia Suportados

```
EstratÃ©gia de NegociaÃ§Ã£o PD:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  PRIORIDADE 1: 20V (Preferido) â˜…
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ 20V @ 1.5A = 30W â†’ 5V @ 5.6A (apÃ³s buck 93%)
  â€¢ 20V @ 3A = 60W â†’ 5V @ 11A (limitado pelo buck a 8A)

  âœ“ DisponÃ­vel em ~85% das fontes PD (laptops, tablets)
  âœ“ Menor corrente no cabo = menores perdas IÂ²R
  âœ“ Maior margem de potÃªncia disponÃ­vel
  âœ“ Ratio 4:1 ainda com boa eficiÃªncia (~91%)

  PRIORIDADE 2: 15V (Fallback)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ 15V @ 2A = 30W â†’ 5V @ 5.6A
  â€¢ 15V @ 3A = 45W â†’ 5V @ 8.4A

  âœ“ DisponÃ­vel em ~70% das fontes PD
  âœ“ Ratio 3:1 ligeiramente melhor eficiÃªncia (~93%)

  PRIORIDADE 3: 9V (Fallback)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ 9V @ 3A = 27W â†’ 5V @ 4.8A (apÃ³s buck 90%)

  âœ“ DisponÃ­vel em ~50% das fontes PD
  âš ï¸ Brilho mÃ¡ximo ~80% (capado em software)
  âš ï¸ Corrente mais alta no cabo (3A)

  FALLBACK FINAL: 5V (EmergÃªncia)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ 5V @ 3A = 15W â†’ Bypass direto (sem buck)

  âš ï¸ Brilho mÃ¡ximo ~40% (capado em software)
  âš ï¸ Apenas para carregadores bÃ¡sicos
  âš ï¸ Requer detecÃ§Ã£o de tensÃ£o para bypass

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 2. Arquitectura do Sistema

### 2.1 Diagrama de Blocos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PSU v3: ARQUITECTURA COMPLETA                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚   â”‚            â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚  FONTE     â”‚      â”‚                      PCB                         â”‚ â”‚
â”‚   â”‚  USB-C PD  â”‚      â”‚                                                  â”‚ â”‚
â”‚   â”‚  27-45W    â”‚      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚   â”‚            â”œâ”€â”€â”€â”€â”€â”€â”¤â”€â–ºâ”‚ USB-C  â”‚â”€â–ºâ”‚ IP2721 â”‚â”€â–ºâ”‚SY8368A â”‚â”€â–ºâ”‚TERMINALâ”‚ â”‚ â”‚
â”‚   â”‚  9V/15V/   â”‚      â”‚  â”‚ Recept.â”‚  â”‚ +MOSFETâ”‚  â”‚ BUCK   â”‚  â”‚PARAFUSOâ”‚ â”‚ â”‚
â”‚   â”‚  20V       â”‚      â”‚  â”‚        â”‚  â”‚AO3400A â”‚  â”‚ 8A     â”‚  â”‚        â”‚ â”‚ â”‚
â”‚   â”‚            â”‚      â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚       â”‚          â”‚           â”‚           â”‚      â”‚ â”‚
â”‚                       â”‚       â”‚   20V (ou 15V/9V)    â”‚    5V     â”‚      â”‚ â”‚
â”‚                       â”‚       â–¼          â”‚           â–¼           â–¼      â”‚ â”‚
â”‚                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚                       â”‚  â”‚ CH340C â”‚      â”‚     â”‚ +5V     â”‚  â”‚ PAINEL â”‚  â”‚ â”‚
â”‚                       â”‚  â”‚ USB-   â”‚      â”‚     â”‚ RAIL    â”‚  â”‚  P10   â”‚  â”‚ â”‚
â”‚                       â”‚  â”‚ UART   â”‚      â”‚     â”‚ (8A)    â”‚  â”‚ HUB75  â”‚  â”‚ â”‚
â”‚                       â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜      â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚                       â”‚       â”‚          â”‚          â”‚                   â”‚ â”‚
â”‚                       â”‚       â”‚          â”‚          â”œâ”€â”€â–º AP2112K 3.3V   â”‚ â”‚
â”‚                       â”‚       â”‚          â”‚          â”‚                   â”‚ â”‚
â”‚                       â”‚       â”‚          â”‚          â”œâ”€â”€â–º 74AHCT245 (x2) â”‚ â”‚
â”‚                       â”‚       â”‚          â”‚          â”‚                   â”‚ â”‚
â”‚                       â”‚       â–¼          â–¼          â–¼                   â”‚ â”‚
â”‚                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚                       â”‚  â”‚              ESP32                  â”‚        â”‚ â”‚
â”‚                       â”‚  â”‚                                     â”‚        â”‚ â”‚
â”‚                       â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚ â”‚
â”‚                       â”‚  â”‚  â”‚ VSENSE_ADC  â”‚  â”‚ Power Managerâ”‚  â”‚        â”‚ â”‚
â”‚                       â”‚  â”‚  â”‚ (GPIO36)    â”‚â”€â”€â”‚ (Firmware)   â”‚  â”‚        â”‚ â”‚
â”‚                       â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚ â”‚
â”‚                       â”‚  â”‚                                     â”‚        â”‚ â”‚
â”‚                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚                       â”‚                                                  â”‚ â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Fluxo de PotÃªncia

```
Fluxo de Energia (15V @ 2A = 30W entrada):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  USB-C         IP2721          SY8368A          Cargas
  Fonte         PD Trigger      Buck Sync
  â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€
    â”‚                â”‚               â”‚               â”‚
    â”‚    VBUS        â”‚               â”‚               â”‚
    â”œâ”€â”€â”€â”€15V @ 2Aâ”€â”€â”€â”€â–º               â”‚               â”‚
    â”‚    (30W)       â”‚               â”‚               â”‚
    â”‚                â”‚               â”‚               â”‚
    â”‚                â”‚  VIN = 15V    â”‚               â”‚
    â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º               â”‚
    â”‚                â”‚               â”‚               â”‚
    â”‚                â”‚               â”‚  VOUT = 5V    â”‚
    â”‚                â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
    â”‚                â”‚               â”‚  Iout = 5.6A  â”‚
    â”‚                â”‚               â”‚  (28W)        â”‚
    â”‚                â”‚               â”‚               â”‚
    â”‚                â”‚    Perdas:    â”‚               â”‚
    â”‚                â”‚    Buck ~2W   â”‚               â”‚
    â”‚                â”‚    (93% eff)  â”‚               â”‚
    â”‚                â”‚               â”‚               â”‚
                                                     â”‚
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                     â”‚               â”‚
                              Painel P10       ESP32 +
                              ~5A (25W)        PerifÃ©ricos
                                               ~0.5A (2.5W)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 3. Componentes Principais

### 3.1 U10 - IP2721 (PD Trigger) + Q3 - AO3400A/AO3404A (Power MOSFET)

O IP2721 Ã© um controlador USB-C PD 2.0/3.0 sink com controlo de MOSFET externo integrado via pino VBUSG.

```
IP2721 - USB-C PD Sink Controller:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  CaracterÃ­sticas:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ Suporta USB PD 2.0/3.0
  â€¢ TensÃµes mÃ¡ximas: 5V, 15V, 20V (via pino SEL)
  â€¢ Fallback automÃ¡tico para tensÃ£o mÃ¡xima suportada
  â€¢ Controlo de MOSFET externo via VBUSG
  â€¢ ProtecÃ§Ã£o integrada (OCP, OVP, short)
  â€¢ Package: TSSOP-16 (4.4x5mm, pitch 0.65mm)
  â€¢ LCSC: C603176 (Extended)

  Pinout IP2721:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          IP2721 (TSSOP-16)        â”‚
        â”‚                                  â”‚
   VIN â”€â”¤1   VIN               VBUS   16â”œâ”€â”€ VBUS (entrada USB-C)
  VOUT â”€â”¤2   VOUT              GND    15â”œâ”€â”€ GND
   N/C â”€â”¤3   N/C               GND    14â”œâ”€â”€ GND
 VBUSG â”€â”¤4   VBUSG             CC2    13â”œâ”€â”€ CC2 (do USB-C)
   GND â”€â”¤5   GND               CC1    12â”œâ”€â”€ CC1 (do USB-C)
   GND â”€â”¤6   GND               N/C    11â”œâ”€â”€ N/C
   SEL â”€â”¤7   SEL               N/C    10â”œâ”€â”€ N/C
   N/C â”€â”¤8   N/C               N/C     9â”œâ”€â”€ N/C
        â”‚                                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ConfiguraÃ§Ã£o de TensÃ£o (pino SEL):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Estado SEL      â”‚ TensÃ£o MÃ¡xima   â”‚ Comportamento           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ High (100kÎ©â†’VIN)â”‚ 20V â˜…           â”‚ Fallback: 15Vâ†’12Vâ†’9Vâ†’5V â”‚
  â”‚ Floating        â”‚ 15V             â”‚ Fallback: 12Vâ†’9Vâ†’5V     â”‚
  â”‚ GND             â”‚ 5V              â”‚ Sem PD (USB bÃ¡sico)     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â˜… ConfiguraÃ§Ã£o recomendada para v3: 20V (SEL â†’ 100kÎ© â†’ VIN)

  ğŸ’¡ Usar jumper/0Î© para facilitar mudanÃ§a de tensÃ£o em produÃ§Ã£o

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AO3400A - N-Channel MOSFET (Power Path):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  CaracterÃ­sticas:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ Vds: 30V (adequado para 20V PD)
  â€¢ Id: 5.7A contÃ­nua (suficiente para aplicaÃ§Ã£o)
  â€¢ Rds(on): 26mÎ© @ Vgs=4.5V
  â€¢ Vgs(th): 1.0-2.5V
  â€¢ Package: SOT-23
  â€¢ LCSC: C20917 (Basic - muito comum!)

  PorquÃª MOSFET externo?
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ IP2721 controla o gate via pino VBUSG
  â€¢ Liga MOSFET quando CC connection estabelecida
  â€¢ Desliga MOSFET quando USB-C desconectado
  â€¢ Soft-start controlado (limita inrush current)
  â€¢ ProtecÃ§Ã£o contra back-feed

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Circuito de AplicaÃ§Ã£o (20V max):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                        USB-C Connector
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        VBUS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ VBUS            â”‚
                       â”‚                 â”‚
        CC1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ CC1             â”‚
        CC2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ CC2             â”‚
                       â”‚                 â”‚
        D+ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ D+              â”‚â”€â”€â–º CH340C
        D- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ D-              â”‚â”€â”€â–º CH340C
                       â”‚                 â”‚
        GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ GND             â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚               â”‚               â”‚
              â–¼               â–¼               â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 IP2721                  â”‚
         â”‚                                         â”‚
   VBUS â”€â”¤ VBUS(16)                   CC1(12) â”œâ”€â”€â”€â–º CC1
         â”‚                                         â”‚
   VIN* â”€â”¤ VIN(1)                     CC2(13) â”œâ”€â”€â”€â–º CC2
         â”‚  * VIN liga ao Source do MOSFET (apÃ³s switch)
         â”‚                                         â”‚
         â”‚ VBUSG(4) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
         â”‚                                â”‚        â”‚
  [100k] â”‚ SEL(7) â”€â”€â”€[100kÎ©]â”€â”€â”€ VIN      â”‚        â”‚
         â”‚             (20V max)          â”‚        â”‚
   VOUT â—„â”¤ VOUT(2)                       â”‚        â”‚
         â”‚                                â”‚        â”‚
   GND â”€â”€â”¤ GND(5,6,14,15)                â”‚        â”‚
         â”‚                                â”‚        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚ GATE
                                          â–¼
                    VBUS â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚                        â”‚
                                 â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                                 â”‚   â”‚    AO3400A      â”‚  â”‚
                                 â”‚   â”‚    N-MOSFET     â”‚  â”‚
                                 â”‚   â”‚                 â”‚  â”‚
                                 â””â”€â”€â”€â”¤ D (Drain)       â”‚  â”‚
                                     â”‚                 â”‚  â”‚
                    VBUSG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ G (Gate)        â”‚  â”‚
                                     â”‚                 â”‚  â”‚
                    VIN_BUCK â—„â”€â”€â”€â”€â”€â”€â”€â”¤ S (Source)      â”‚  â”‚
                                     â”‚                 â”‚  â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                          â”‚               â”‚
                                          â”‚               â”‚
                                          â–¼               â”‚
                                    Para SY8368A         â”‚
                                    (VIN = atÃ© 20V)      â”‚
                                                         â”‚
                    GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Fallback AutomÃ¡tico:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  O IP2721 negocia automaticamente a tensÃ£o mÃ¡xima suportada
  por AMBOS (fonte PD e configuraÃ§Ã£o SEL).

  Exemplo (SEL = 20V max):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Fonte PD suporta        â”‚ IP2721 negocia   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 20V, 15V, 9V, 5V        â”‚ 20V âœ“            â”‚
  â”‚ 15V, 9V, 5V             â”‚ 15V âœ“ (fallback) â”‚
  â”‚ 9V, 5V                  â”‚ 9V âœ“ (fallback)  â”‚
  â”‚ 5V sÃ³                   â”‚ 5V âœ“ (fallback)  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  O firmware do ESP32 detecta a tensÃ£o real via ADC e ajusta
  o brilho mÃ¡ximo em conformidade.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.2 U12 - SY8368AQQC (Buck SÃ­ncrono 8A)

O SY8368AQQC Ã© um buck converter sÃ­ncrono de alta eficiÃªncia com MOSFETs integrados.

```
SY8368AQQC - Buck Converter 8A:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  CaracterÃ­sticas:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ TensÃ£o entrada: 4.5V - 18V
  â€¢ TensÃ£o saÃ­da: 0.6V - VIN
  â€¢ Corrente: 8A contÃ­nua
  â€¢ FrequÃªncia: 500kHz (ajustÃ¡vel)
  â€¢ EficiÃªncia: 93% @ 15Vâ†’5V, 3A
  â€¢ MOSFETs integrados (sÃ­ncrono)
  â€¢ Package: QFN-20 (3x3mm)
  â€¢ LCSC: C207642

  Pinout:
  â”€â”€â”€â”€â”€â”€â”€

              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   SY8368AQQC (QFN20) â”‚
              â”‚                      â”‚
       BOOT â”€â”¤1                  20â”œâ”€ VIN
        SW â”€â”€â”¤2                  19â”œâ”€ VIN
        SW â”€â”€â”¤3                  18â”œâ”€ EN
        SW â”€â”€â”¤4                  17â”œâ”€ SS
       PGND â”€â”¤5                  16â”œâ”€ PGOOD
       PGND â”€â”¤6                  15â”œâ”€ COMP
       PGND â”€â”¤7                  14â”œâ”€ FB
       PGND â”€â”¤8                  13â”œâ”€ SGND
       PGND â”€â”¤9                  12â”œâ”€ SGND
       PGND â”€â”¤10                 11â”œâ”€ MODE
              â”‚                      â”‚
              â”‚      (PAD = PGND)    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Circuito de AplicaÃ§Ã£o (20V â†’ 5V @ 8A):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                     VIN = 5-20V (do IP2721 via AO3400A)
                          â”‚
                          â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚             â”‚                                     â”‚
           â•â•§â•           â•â•§â•                                    â”‚
       C_IN1          C_IN2                                     â”‚
      22ÂµF/25V       22ÂµF/25V                                   â”‚
       (1210)         (1210)                                    â”‚
            â”‚             â”‚                                     â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
                   â”‚                                            â”‚
                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                   â”‚  â”‚           SY8368AQQC                â”‚   â”‚
                   â”‚  â”‚                                     â”‚   â”‚
                   â”œâ”€â”€â”¤ VIN (19,20)                         â”‚   â”‚
                   â”‚  â”‚                                     â”‚   â”‚
                   â”‚  â”‚ EN (18) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¤
                   â”‚  â”‚              (ligar a VIN via 10k)  â”‚   â”‚
                   â”‚  â”‚                                     â”‚   â”‚
                   â”‚  â”‚ SS (17) â”€â”€â”€â”€â”€[10nF]â”€â”€â”€â”¬â”€ GND        â”‚   â”‚
                   â”‚  â”‚                       â”‚             â”‚   â”‚
                   â”‚  â”‚ MODE (11) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[GND] (forced CCM) â”‚
                   â”‚  â”‚                                     â”‚   â”‚
                   â”‚  â”‚ FB (14) â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚   â”‚
                   â”‚  â”‚                      â”‚              â”‚   â”‚
                   â”‚  â”‚ COMP (15) â”€â”€â”€[R_C]â”€â”€â”€â”¼â”€â”€[C_C]â”€ GND  â”‚   â”‚
                   â”‚  â”‚                      â”‚              â”‚   â”‚
                   â”‚  â”‚ PGOOD (16) â”€â—‹ (opcional ao ESP32)   â”‚   â”‚
                   â”‚  â”‚                                     â”‚   â”‚
                   â”‚  â”‚ BOOT (1) â”€â”€â”€[100nF]â”€â”€â”¤              â”‚   â”‚
                   â”‚  â”‚                      â”‚              â”‚   â”‚
                   â”‚  â”‚ SW (2,3,4) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
                   â”‚  â”‚                      â”‚              â”‚   â”‚
                   â”‚  â”‚ PGND (5-10,PAD) â”€â”€â”€â”€â”€â”´â”€ GND         â”‚   â”‚
                   â”‚  â”‚                                     â”‚   â”‚
                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                   â”‚                      â”‚                     â”‚
                   â”‚                      â”‚ SW                  â”‚
                   â”‚                      â”‚                     â”‚
                   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”             â”‚
                   â”‚              â”‚               â”‚             â”‚
                   â”‚             â•â•ªâ•             â•â•§â•            â”‚
                   â”‚          L1 2.2ÂµH       C_BOOT             â”‚
                   â”‚           10A          100nF               â”‚
                   â”‚              â”‚               â”‚             â”‚
                   â”‚              â”‚               â”‚             â”‚
                   â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                   â”‚              â”‚                             â”‚
                   â”‚              â”‚ VOUT = 5V                   â”‚
                   â”‚              â”‚                             â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
            â”‚                     â”‚                       â”‚     â”‚
           â•â•§â•                   â•â•§â•                     â•â•§â•    â”‚
       C_OUT1                C_OUT2                  C_OUT3     â”‚
      22ÂµF/10V              22ÂµF/10V                22ÂµF/10V    â”‚
       (1206)                (1206)                  (1206)     â”‚
            â”‚                     â”‚                       â”‚     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                                  â”‚                             â”‚
                                  â”‚                             â”‚
                                 â•â•§â•                            â”‚
                            C_BULK                              â”‚
                          470-1000ÂµF                            â”‚
                          10V Elect.                            â”‚
                          (opcional)                            â”‚
                                  â”‚                             â”‚
                                  â”‚                             â”‚
      GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  Rede de Feedback (5.0V):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                          VOUT = 5V
                              â”‚
                              â”‚
                             [R1]  22kÎ© (1%)
                              â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º FB (pino 14)
                              â”‚
                             [R2]  3kÎ© (1%)
                              â”‚
                             GND

  CÃ¡lculo: VOUT = 0.6V Ã— (1 + R1/R2) = 0.6 Ã— (1 + 22/3) = 5.0V âœ“


  Rede de CompensaÃ§Ã£o:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  COMP (pino 15) â”€â”€â”€[R_C 10kÎ©]â”€â”€â”€â”¬â”€â”€â”€[C_C 22nF]â”€â”€â”€ GND
                                 â”‚
                            [C_HF 100pF]
                                 â”‚
                                GND

  (Valores tÃ­picos para 500kHz, ajustar conforme estabilidade)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.3 L1 - Indutor 2.2ÂµH / 10A

```
Indutor para Buck Converter:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  EspecificaÃ§Ãµes:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ Valor: 2.2ÂµH
  â€¢ Corrente saturaÃ§Ã£o: â‰¥10A
  â€¢ Corrente RMS: â‰¥8A
  â€¢ DCR: <15mÎ© (baixa perda)
  â€¢ Package: Shielded (baixo EMI)

  Componente Recomendado:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  CKST0603-2.2uH/M                                           â”‚
  â”‚                                                             â”‚
  â”‚  â€¢ IndutÃ¢ncia: 2.2ÂµH                                        â”‚
  â”‚  â€¢ Isat: 10.5A                                              â”‚
  â”‚  â€¢ Irms: 9.2A                                               â”‚
  â”‚  â€¢ DCR: 8.5mÎ©                                               â”‚
  â”‚  â€¢ Package: 6.6Ã—6.6Ã—3mm (SMD)                               â”‚
  â”‚  â€¢ LCSC: C3002634 (Extended)                                â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Alternativas (Basic Stock):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Part Number          â”‚ Value  â”‚ Isat  â”‚ DCR   â”‚ LCSC            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ **SRP1265A-2R2M** â˜…  â”‚ 2.2ÂµH  â”‚ 22A   â”‚ 4.2mÎ© â”‚ **C2831487**    â”‚
  â”‚ SWPA6045S2R2MT       â”‚ 2.2ÂµH  â”‚ 8.5A  â”‚ 16mÎ©  â”‚ C408335         â”‚
  â”‚ WPN5040S2R2MT        â”‚ 2.2ÂµH  â”‚ 10A   â”‚ 12mÎ©  â”‚ C495537         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â˜… Usado no KiCad v3 - Bourns SRP1265A-2R2M (Extended, LCSC C2831487)

  Dimensionamento:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  FrequÃªncia: f_sw = 500kHz
  Ripple desejado: Î”I = 30% Ã— I_out = 0.3 Ã— 8A = 2.4A

  L = (VIN - VOUT) Ã— VOUT / (VIN Ã— f_sw Ã— Î”I)
  L = (15 - 5) Ã— 5 / (15 Ã— 500k Ã— 2.4)
  L = 50 / 18M = 2.78ÂµH

  â†’ 2.2ÂµH Ã© adequado (ripple ~35%, dentro do aceitÃ¡vel)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.4 Condensadores

```
Condensadores de Entrada e SaÃ­da:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ENTRADA (perto do SY8368A):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Requisito: Suportar ripple de corrente de entrada do buck
  MÃ­nimo: 2Ã— 22ÂµF/25V MLCC (1210)
  Recomendado: 4Ã— 22ÂµF/25V para menor ESR

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  CL32A226KAJNNNE (Samsung)                                  â”‚
  â”‚                                                             â”‚
  â”‚  â€¢ CapacitÃ¢ncia: 22ÂµF                                       â”‚
  â”‚  â€¢ TensÃ£o: 25V                                              â”‚
  â”‚  â€¢ Package: 1210                                            â”‚
  â”‚  â€¢ DielÃ©trico: X5R                                          â”‚
  â”‚  â€¢ LCSC: C52306 (Basic)                                     â”‚
  â”‚  â€¢ PreÃ§o: ~â‚¬0.08/un                                         â”‚
  â”‚                                                             â”‚
  â”‚  Quantidade: 2-4 unidades em paralelo                       â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SAÃDA (perto do SY8368A):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Requisito: Baixo ESR para resposta transitÃ³ria rÃ¡pida
  MÃ­nimo: 4Ã— 22ÂµF/10V MLCC (1206)
  Recomendado: 6-8Ã— para melhor resposta a picos

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  CL31A226KAHL (Samsung)                                     â”‚
  â”‚                                                             â”‚
  â”‚  â€¢ CapacitÃ¢ncia: 22ÂµF                                       â”‚
  â”‚  â€¢ TensÃ£o: 10V (ou 25V para margem extra)                   â”‚
  â”‚  â€¢ Package: 1206                                            â”‚
  â”‚  â€¢ DielÃ©trico: X5R                                          â”‚
  â”‚  â€¢ LCSC: C12891 (Basic)                                     â”‚
  â”‚  â€¢ PreÃ§o: ~â‚¬0.03/un                                         â”‚
  â”‚                                                             â”‚
  â”‚  Quantidade: 4-8 unidades em paralelo                       â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  BULK (perto do HUB75 / terminais):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Requisito: Absorver "coices" de corrente do painel HUB75
  Tipo: ElectrolÃ­tico ou Polymer de baixo ESR

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  ElectrolÃ­tico 470ÂµF-1000ÂµF / 10-16V                        â”‚
  â”‚                                                             â”‚
  â”‚  OpÃ§Ãµes:                                                    â”‚
  â”‚  â€¢ 470ÂµF/16V: LCSC C3339 (Î¦8Ã—10.5mm)                       â”‚
  â”‚  â€¢ 1000ÂµF/10V: LCSC C249287 (Î¦10Ã—12.5mm)                   â”‚
  â”‚  â€¢ 1000ÂµF/16V: LCSC C249288 (Î¦10Ã—16mm)                     â”‚
  â”‚                                                             â”‚
  â”‚  âš ï¸ IMPORTANTE:                                             â”‚
  â”‚  Deixar footprint mesmo que nÃ£o monte de inÃ­cio.            â”‚
  â”‚  PainÃ©is HUB75 causam picos de corrente que podem           â”‚
  â”‚  provocar instabilidade sem bulk capacitance.               â”‚
  â”‚                                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  Layout Recomendado:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                    VIN (15V)                    VOUT (5V)
                       â”‚                            â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚               â”‚   â”‚       â”‚                       â”‚
      â•â•§â•             â•â•§â•             â•â•§â• â•â•§â•     â•â•§â•                      â”‚
   C_IN1           C_IN2           C_IN3 C_OUT1 C_OUT2                    â”‚
   22ÂµF            22ÂµF            22ÂµF  22ÂµF   22ÂµF                      â”‚
       â”‚               â”‚               â”‚   â”‚       â”‚                       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚
                       â”‚                           â”‚                       â”‚
                       â–¼                           â–¼                       â”‚
                 Perto do IC              Perto do IC                      â”‚
                                                                           â”‚
                                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                                              â”‚            â”‚
                                                             â•â•§â•          â•â•§â•
                                                          C_BULK      C_TERM
                                                         470-1000ÂµF   100ÂµF
                                                         (opcional)   (no HUB75)
                                                              â”‚            â”‚
                                                              â”‚            â”‚
                                         Perto do terminal â—„â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         de parafuso / HUB75

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 4. Circuito Completo

### 4.1 Esquema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PSU v3 - ESQUEMA COMPLETO                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                          USB-C Connector (J1)                               â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚     VBUS (A4,A9,B4,B9) â”€â”¤ VBUS                â”‚                             â”‚
â”‚                         â”‚                     â”‚                             â”‚
â”‚              GND â”€â”€â”€â”€â”€â”€â”€â”¤ GND                 â”‚                             â”‚
â”‚                         â”‚                     â”‚                             â”‚
â”‚              D+ â”€â”€â”€â”€â”€â”€â”€â”€â”¤ D+ (A6,B6)          â”‚â”€â”€â–º CH340C (dados USB)       â”‚
â”‚              D- â”€â”€â”€â”€â”€â”€â”€â”€â”¤ D- (A7,B7)          â”‚â”€â”€â–º CH340C (dados USB)       â”‚
â”‚                         â”‚                     â”‚                             â”‚
â”‚             CC1 â”€â”€â”€â”€â”€â”€â”€â”€â”¤ CC1 (A5)            â”‚                             â”‚
â”‚             CC2 â”€â”€â”€â”€â”€â”€â”€â”€â”¤ CC2 (B5)            â”‚                             â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                â”‚                                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚                    â”‚           â”‚           â”‚                                â”‚
â”‚                    â–¼           â–¼           â–¼                                â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚               â”‚     IP2721 (U10) + AO3404A (Q3) â”‚                           â”‚
â”‚               â”‚          PD + Power Path        â”‚                           â”‚
â”‚               â”‚                                 â”‚                           â”‚
â”‚     VBUS â”€â”€â”€â”€â”€â”¤ VBUS(16)              CC1(12)â”€â”€â”€â”¼â”€â–º CC1                     â”‚
â”‚               â”‚                                 â”‚                           â”‚
â”‚     VBUS â”€â”€â”€â”€â”€â”¤ VIN(1)               CC2(13) â”€â”€â”€â”¼â”€â–º CC2                     â”‚
â”‚               â”‚                                 â”‚                           â”‚
â”‚               â”‚ VBUSG(4)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   GND â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º GND                     â”‚
â”‚               â”‚                  â”‚              â”‚                           â”‚
â”‚  [100kÎ©]â”€â”€VINâ”€â”¤ SEL(7)           â”‚              â”‚                           â”‚
â”‚               â”‚                  â”‚              â”‚                           â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                  â”‚                                          â”‚
â”‚                                  â”‚ GATE                                     â”‚
â”‚                                  â–¼                                          â”‚
â”‚                    VBUS â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚                             â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                      â”‚
â”‚                             â”‚   â”‚    AO3400A      â”‚  â”‚                      â”‚
â”‚                             â””â”€â”€â”€â”¤ D          S â”œâ”€â”€â”¼â”€â”€â–º VIN_BUCK             â”‚
â”‚                    VBUSG â”€â”€â”€â”€â”€â”€â”€â”¤ G              â”‚  â”‚                       â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                      â”‚
â”‚                                                      â”‚                      â”‚
â”‚                         â”‚ VIN = 5-20V (apÃ³s MOSFET)                         â”‚
â”‚                         â”‚                                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚               â”‚                               â”‚                   â”‚
â”‚        â•â•§â•             â•â•§â•                              â”‚                   â”‚
â”‚    C_IN1 22ÂµF      C_IN2 22ÂµF                           â”‚                   â”‚
â”‚    25V (1210)      25V (1210)                           â”‚                   â”‚
â”‚         â”‚               â”‚                               â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚                   â”‚
â”‚                 â”‚                                       â”‚                   â”‚
â”‚                 â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚
â”‚                 â”‚    â”‚                                  â”‚                   â”‚
â”‚                 â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚      SY8368AQQC (U12)       â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚       Buck 8A               â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚                             â”‚ â”‚                   â”‚
â”‚                 â”œâ”€â”€â”€â”€â”¼â”€â”€â”¤ VIN (19,20)                 â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚                             â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ EN (18) â—„â”€â”€[10k]â”€â”€â”¬         â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚                   â”‚         â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ SS (17) â”€â”€[10nF]â”€â”€â”´â”€ GND    â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚                             â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ MODE (11) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GND    â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚                             â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ FB (14) â—„â”€â”€â”¤                â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚            â”‚                â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ COMP (15)â”€â”€â”¼â”€[Rede Comp]    â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚            â”‚                â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ PGOOD (16)â”€â—‹ (ao ESP32)     â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚            â”‚                â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ BOOT (1)â”€â”€â”€â”¼â”€â”€[100nF]â”€â”€â”    â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚            â”‚           â”‚    â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ SW (2,3,4)â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚            â”‚           â”‚    â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚ PGND â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€ GND   â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â”‚                             â”‚ â”‚                   â”‚
â”‚                 â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                   â”‚
â”‚                 â”‚    â”‚               â”‚                  â”‚                   â”‚
â”‚                 â”‚    â”‚               â”‚ SW               â”‚                   â”‚
â”‚                 â”‚    â”‚               â”‚                  â”‚                   â”‚
â”‚                 â”‚    â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”          â”‚                   â”‚
â”‚                 â”‚    â”‚       â”‚               â”‚          â”‚                   â”‚
â”‚                 â”‚    â”‚      â•â•ªâ•             â•â•§â•         â”‚                   â”‚
â”‚                 â”‚    â”‚   L1 2.2ÂµH       C_BOOT          â”‚                   â”‚
â”‚                 â”‚    â”‚    10A           100nF           â”‚                   â”‚
â”‚                 â”‚    â”‚       â”‚               â”‚          â”‚                   â”‚
â”‚                 â”‚    â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                   â”‚
â”‚                 â”‚    â”‚       â”‚                          â”‚                   â”‚
â”‚                 â”‚    â”‚       â”‚ VOUT = 5V                â”‚                   â”‚
â”‚                 â”‚    â”‚       â”‚                          â”‚                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚       â”‚    â”‚       â”‚                                              â”‚
â”‚         â”‚       â”‚    â”‚       â”‚                                              â”‚
â”‚         â”‚      â•â•§â•  â•â•§â•     â•â•§â•                                             â”‚
â”‚         â”‚   R1      R2    C_OUT (x4-8)                                      â”‚
â”‚         â”‚  22k     3k      22ÂµF/10V                                         â”‚
â”‚         â”‚       â”‚    â”‚       â”‚                                              â”‚
â”‚         â”‚       â””â”€â”€â”€â”€â”¤       â”‚                                              â”‚
â”‚         â”‚            â”‚       â”‚                                              â”‚
â”‚         â”‚         â”€â”€â”€â”´â”€â”€â”€    â”‚                                              â”‚
â”‚         â”‚           FB       â”‚                                              â”‚
â”‚         â”‚                    â”‚                                              â”‚
â”‚         â”‚                    â”‚      +5V RAIL                                â”‚
â”‚         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚
â”‚         â”‚                    â”‚                                              â”‚
â”‚         â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚         â”‚           â”‚        â”‚                â”‚               â”‚             â”‚
â”‚         â”‚          â•â•§â•      â•â•§â•              â•â•§â•              â”‚             â”‚
â”‚         â”‚      C_BULK    C_TERM1         C_TERM2              â”‚             â”‚
â”‚         â”‚     470-1000ÂµF  100ÂµF           22ÂµF                â”‚             â”‚
â”‚         â”‚      (opt)      (opt)          (1206)               â”‚             â”‚
â”‚         â”‚           â”‚        â”‚                â”‚               â”‚             â”‚
â”‚         â”‚           â”‚        â”‚                â”‚               â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â–º GND       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Divisor de TensÃ£o para Sensing (ADC)

```
MediÃ§Ã£o de TensÃ£o de Entrada (para detecÃ§Ã£o de perfil):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  O ESP32 mede a tensÃ£o de entrada para detectar o perfil PD
  negociado e ajustar o brilho mÃ¡ximo automaticamente.

  VIN apÃ³s MOSFET (5V-20V)
          â”‚
          â”‚
         [R3]  100kÎ© (1%)
          â”‚
          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º GPIO36 (ADC1_CH0) do ESP32
          â”‚
         [R4]  22kÎ© (1%)
          â”‚
          â”‚
         â•â•§â•  C_FILTER
        100nF
          â”‚
          â”‚
         GND

  Divisor: 22k / (100k + 22k) = 0.18

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ TensÃ£o PD â”‚ ApÃ³s Divisor â”‚ ADC (12-bit) â”‚ Perfil         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 5V        â”‚ 0.90V        â”‚ ~1117        â”‚ USB_5V_3A      â”‚
  â”‚ 9V        â”‚ 1.62V        â”‚ ~2011        â”‚ PD_9V (27W)    â”‚
  â”‚ 12V       â”‚ 2.16V        â”‚ ~2681        â”‚ PD_12V (36W)   â”‚
  â”‚ 15V       â”‚ 2.70V        â”‚ ~3351        â”‚ PD_15V (45W)   â”‚
  â”‚ 20V       â”‚ 3.60V        â”‚ ~4095 (sat)  â”‚ PD_20V (60W+)  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš ï¸ Nota: Para 20V, o divisor satura o ADC.
  Pode usar 100k/15k (0.13) para range completo, ou
  aceitar que 20V = "saturado = potÃªncia mÃ¡xima".

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 5. GestÃ£o de Brilho por Software

### 5.1 Perfis de PotÃªncia

```
Mapeamento PotÃªncia â†’ Brilho MÃ¡ximo:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Perfil          â”‚ PotÃªncia   â”‚ Corrente 5V  â”‚ Brilho Max   â”‚
  â”‚                 â”‚ DisponÃ­vel â”‚ DisponÃ­vel   â”‚ (Software)   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ PD_20V_3A       â”‚ 60W        â”‚ 10A+ (cap 8A)â”‚ 100%         â”‚
  â”‚ PD_15V_3A       â”‚ 45W        â”‚ 8A           â”‚ 100%         â”‚
  â”‚ PD_15V_2A       â”‚ 30W        â”‚ 5.6A         â”‚ 100%         â”‚
  â”‚ PD_12V_3A       â”‚ 36W        â”‚ 6.5A         â”‚ 100%         â”‚
  â”‚ PD_9V_3A        â”‚ 27W        â”‚ 4.8A         â”‚ 80%  âš ï¸      â”‚
  â”‚ USB_5V_3A       â”‚ 15W        â”‚ 2.8A (bypass)â”‚ 40%  âš ï¸      â”‚
  â”‚ USB_5V_1.5A     â”‚ 7.5W       â”‚ 1.4A         â”‚ 20%  âš ï¸      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš ï¸ = Brilho capado em software para evitar overcurrent

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 5.2 CÃ³digo Firmware

```cpp
// firmware/power_manager_v3.h
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#ifndef POWER_MANAGER_V3_H
#define POWER_MANAGER_V3_H

#include <Arduino.h>
#include <ESP32-HUB75-MatrixPanel-I2S-DMA.h>

// Pino ADC para medir tensÃ£o de entrada (apÃ³s divisor 100k/22k)
#define VSENSE_PIN 36  // GPIO36 (ADC1_CH0)

// Divisor de tensÃ£o: 22k / (100k + 22k) = 0.18
#define VOLTAGE_DIVIDER_RATIO 0.18f

// Thresholds de tensÃ£o (com histerese)
#define THRESH_20V  17.0f   // >17V = 20V PD
#define THRESH_15V  13.0f   // >13V = 15V PD
#define THRESH_12V  10.5f   // >10.5V = 12V PD
#define THRESH_9V    7.5f   // >7.5V = 9V PD
#define THRESH_5V    4.0f   // >4V = 5V USB

enum PowerProfile {
    PROFILE_UNKNOWN = 0,
    PROFILE_USB_5V,      // 5V USB direto (bypass buck)
    PROFILE_PD_9V,       // 9V @ 3A = 27W
    PROFILE_PD_12V,      // 12V @ 3A = 36W
    PROFILE_PD_15V,      // 15V @ 2-3A = 30-45W (preferido)
    PROFILE_PD_20V       // 20V @ 3A = 60W
};

struct PowerConfig {
    PowerProfile profile;
    float inputVoltage;
    float maxBrightness;    // 0.0 - 1.0
    uint16_t maxCurrentMA;  // mA disponÃ­veis no rail 5V
    bool buckActive;        // true se buck estÃ¡ em uso
};

class PowerManagerV3 {
private:
    MatrixPanel_I2S_DMA* display;
    PowerConfig config;

    // CalibraÃ§Ã£o ADC (ajustar em produÃ§Ã£o)
    float adcCalibration = 1.0f;

public:
    PowerManagerV3(MatrixPanel_I2S_DMA* dma_display) {
        display = dma_display;
        config.profile = PROFILE_UNKNOWN;
        config.inputVoltage = 0;
        config.maxBrightness = 0.25f;  // Conservador atÃ© detectar
        config.maxCurrentMA = 1500;
        config.buckActive = false;
    }

    // Medir tensÃ£o de entrada via ADC
    float measureInputVoltage() {
        // MÃ©dia de mÃºltiplas leituras para estabilidade
        uint32_t sum = 0;
        for (int i = 0; i < 16; i++) {
            sum += analogRead(VSENSE_PIN);
            delayMicroseconds(100);
        }
        float adcValue = sum / 16.0f;

        // Converter para tensÃ£o real
        // ADC 12-bit: 0-4095 = 0-3.3V (com atenuaÃ§Ã£o default)
        float adcVoltage = (adcValue / 4095.0f) * 3.3f;
        config.inputVoltage = (adcVoltage / VOLTAGE_DIVIDER_RATIO) * adcCalibration;

        return config.inputVoltage;
    }

    // Detectar perfil de potÃªncia
    PowerProfile detectProfile() {
        float vin = measureInputVoltage();

        PowerProfile newProfile;

        if (vin >= THRESH_20V) {
            newProfile = PROFILE_PD_20V;
            config.maxBrightness = 1.0f;
            config.maxCurrentMA = 8000;
            config.buckActive = true;
        }
        else if (vin >= THRESH_15V) {
            newProfile = PROFILE_PD_15V;
            config.maxBrightness = 1.0f;
            config.maxCurrentMA = 8000;
            config.buckActive = true;
        }
        else if (vin >= THRESH_12V) {
            newProfile = PROFILE_PD_12V;
            config.maxBrightness = 1.0f;
            config.maxCurrentMA = 6500;
            config.buckActive = true;
        }
        else if (vin >= THRESH_9V) {
            newProfile = PROFILE_PD_9V;
            config.maxBrightness = 0.80f;  // âš ï¸ Capado a 80%
            config.maxCurrentMA = 4800;
            config.buckActive = true;
        }
        else if (vin >= THRESH_5V) {
            newProfile = PROFILE_USB_5V;
            config.maxBrightness = 0.40f;  // âš ï¸ Capado a 40%
            config.maxCurrentMA = 2800;
            config.buckActive = false;  // Bypass direto
        }
        else {
            newProfile = PROFILE_UNKNOWN;
            config.maxBrightness = 0.20f;  // Muito conservador
            config.maxCurrentMA = 1000;
            config.buckActive = false;
        }

        // Log mudanÃ§a de perfil
        if (newProfile != config.profile) {
            config.profile = newProfile;
            logProfileChange();
        }

        return config.profile;
    }

    // Aplicar brilho mÃ¡ximo ao display
    void applyBrightness(float requestedBrightness = 1.0f) {
        // Limitar ao mÃ¡ximo permitido pelo perfil
        float actualBrightness = min(requestedBrightness, config.maxBrightness);
        uint8_t brightness8 = (uint8_t)(actualBrightness * 255);

        display->setBrightness8(brightness8);

        Serial.printf("[PWR] Brilho: %.0f%% (pedido: %.0f%%, max: %.0f%%)\n",
                      actualBrightness * 100,
                      requestedBrightness * 100,
                      config.maxBrightness * 100);
    }

    // Brilho adaptativo baseado no conteÃºdo
    void adjustForContent(uint16_t activePixels, uint16_t totalPixels) {
        float fillRatio = (float)activePixels / totalPixels;

        // Quanto mais pixels activos, mais conservador
        float contentFactor = 1.0f;
        if (fillRatio > 0.7f) contentFactor = 0.7f;
        else if (fillRatio > 0.5f) contentFactor = 0.85f;
        else if (fillRatio > 0.3f) contentFactor = 0.95f;

        float effectiveBrightness = config.maxBrightness * contentFactor;
        uint8_t brightness8 = (uint8_t)(effectiveBrightness * 255);

        display->setBrightness8(brightness8);
    }

    // Getters
    PowerConfig getConfig() const { return config; }
    float getMaxBrightness() const { return config.maxBrightness; }
    float getInputVoltage() const { return config.inputVoltage; }
    bool isBuckActive() const { return config.buckActive; }

    // CalibraÃ§Ã£o (chamar com tensÃ£o conhecida)
    void calibrate(float knownVoltage) {
        float measured = measureInputVoltage();
        if (measured > 0) {
            adcCalibration = knownVoltage / (measured / adcCalibration);
            Serial.printf("[PWR] CalibraÃ§Ã£o: factor = %.3f\n", adcCalibration);
        }
    }

private:
    void logProfileChange() {
        const char* profileNames[] = {
            "UNKNOWN", "USB_5V", "PD_9V", "PD_12V", "PD_15V", "PD_20V"
        };

        Serial.println("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
        Serial.printf( "â•‘  Power Profile: %-24s  â•‘\n", profileNames[config.profile]);
        Serial.printf( "â•‘  Input Voltage: %.1fV                     â•‘\n", config.inputVoltage);
        Serial.printf( "â•‘  Max Current:   %dmA                   â•‘\n", config.maxCurrentMA);
        Serial.printf( "â•‘  Max Brightness: %.0f%%                     â•‘\n", config.maxBrightness * 100);
        Serial.printf( "â•‘  Buck Active:   %s                      â•‘\n", config.buckActive ? "Yes" : "No ");
        Serial.println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
    }
};

#endif // POWER_MANAGER_V3_H
```

### 5.3 Exemplo de Uso

```cpp
// main.cpp - Exemplo de integraÃ§Ã£o
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

#include <ESP32-HUB75-MatrixPanel-I2S-DMA.h>
#include "power_manager_v3.h"

MatrixPanel_I2S_DMA* display = nullptr;
PowerManagerV3* powerMgr = nullptr;

void setup() {
    Serial.begin(115200);

    // Inicializar display
    HUB75_I2S_CFG mxconfig(32, 16, 1);
    display = new MatrixPanel_I2S_DMA(mxconfig);
    display->begin();

    // Inicializar gestor de energia
    powerMgr = new PowerManagerV3(display);

    // Esperar estabilizaÃ§Ã£o da fonte (soft-start do buck)
    delay(100);

    // Detectar perfil de potÃªncia
    powerMgr->detectProfile();

    // Aplicar brilho mÃ¡ximo permitido
    powerMgr->applyBrightness(1.0f);  // Pede 100%, recebe o permitido
}

void loop() {
    // Re-verificar perfil periodicamente (hot-plug de fonte diferente)
    static uint32_t lastCheck = 0;
    if (millis() - lastCheck > 5000) {  // A cada 5 segundos
        powerMgr->detectProfile();
        powerMgr->applyBrightness(1.0f);
        lastCheck = millis();
    }

    // ... resto do cÃ³digo do relÃ³gio ...

    // Exemplo: ajustar brilho baseado no conteÃºdo
    // uint16_t activePixels = countActivePixels();  // Implementar
    // powerMgr->adjustForContent(activePixels, 32 * 16);
}
```

---

## 6. Bill of Materials (BOM)

### 6.1 Componentes Principais PSU

| Ref | Componente | EspecificaÃ§Ã£o | Package | Qty | PreÃ§o | LCSC | Stock |
|-----|------------|---------------|---------|-----|-------|------|-------|
| U10 | IP2721 | USB-C PD Trigger | TSSOP-16 | 1 | â‚¬0.40 | C603176 | Extended |
| Q3 | AO3400A / AO3404A | N-MOSFET 30V ~5A | SOT-23 | 1 | â‚¬0.03 | C20917 | Basic |
| U12 | SY8368AQQC | Buck Sync 8A | QFN-20 3x3 | 1 | â‚¬0.55 | C207642 | Basic |
| L1 | **Bourns SRP1265A-2R2M** | Indutor 2.2ÂµH 22A | 12.5x12.5x6.5mm | 1 | â‚¬0.30 | **C2831487** | Extended |
| | *Alt: CKST0603-2.2uH/M* | *2.2ÂµH 10A* | *6.6x6.6x3mm* | 1 | â‚¬0.25 | C3002634 | Extended |
| C_BOOT1 | 100nF 50V | MLCC X7R | 0402 | 1 | â‚¬0.01 | C307331 | Basic |
| C14,C15 | CL32A226KAJNNNE | MLCC 22ÂµF 25V | 1210 | 2 | â‚¬0.08 | C52306 | Basic |
| C_OUT1-4 | CL31A226KAHL | MLCC 22ÂµF 25V | 1206 | 4 | â‚¬0.03 | C52306 | Basic |
| C_BULK | 470ÂµF 16V | ElectrolÃ­tico | Î¦8x10mm | 1 | â‚¬0.08 | C3339 | Basic |
| C17 | 1ÂµF 50V | VCC Buck bypass | 0603 | 1 | â‚¬0.01 | C15849 | Basic |
| R_FB1 | 22kÎ© 1% | Resistor (FB upper) | 0603 | 1 | â‚¬0.01 | C31850 | Basic |
| R_FB2 | 3kÎ© 1% | Resistor (FB lower) | 0603 | 1 | â‚¬0.01 | C4211 | Basic |
| R9 | 100kÎ© 1% | SELâ†’VIN (20V max) | 0402 | 1 | â‚¬0.01 | C25741 | Basic |
| R3,R4 | 5.1kÎ© | CC1/CC2 resistors | 0402 | 2 | â‚¬0.01 | C25905 | Basic |
| **Total PSU** | | | | | **~â‚¬2.30** | | |

### 6.2 Componentes Sensing (ADC)

| Ref | Componente | EspecificaÃ§Ã£o | Package | Qty | PreÃ§o | LCSC |
|-----|------------|---------------|---------|-----|-------|------|
| R_SENSE1 | 100kÎ© 1% | Divisor tensÃ£o | 0402 | 1 | â‚¬0.01 | C25741 |
| R_SENSE2 | 22kÎ© 1% | Divisor tensÃ£o | 0402 | 1 | â‚¬0.01 | C25768 |
| C_FILTER | 100nF 16V | Filtro ADC | 0402 | 1 | â‚¬0.01 | C307331 |
| **Total Sensing** | | | | | **â‚¬0.03** | |

### 6.3 ProteÃ§Ãµes e Conectores

| Ref | Componente | EspecificaÃ§Ã£o | Package | Qty | PreÃ§o | LCSC | Stock |
|-----|------------|---------------|---------|-----|-------|------|-------|
| J1 | USB-C Receptacle | GCT USB4105-GF-A 16-pin | SMD | 1 | â‚¬0.40 | C3020560 | Extended |
| F1 | PTC Fuse | ASMD2920-300 3A/30V | 2920 | 1 | â‚¬0.05 | C2982291 | Extended |
| D3 | H7VN10B | TVS USB VBUS | DFN1006-2L | 1 | â‚¬0.05 | C20615788 | Extended |
| D4 | SMBJ5.0A | TVS 5V output | SMB | 1 | â‚¬0.08 | C113620 | Basic |
| J3 | Barrier Terminal | KF301-5.0-2P 10A | THT | 1 | â‚¬0.10 | C474881 | Extended |
| J6 | Pin Header 1Ã—3 | J_MODE selector | 2.54mm | 1 | â‚¬0.02 | C2337 | Basic |
| **Total ProteÃ§Ãµes** | | | | | **â‚¬0.70** | | |

### 6.4 Regulador 3.3V e PerifÃ©ricos

| Ref | Componente | EspecificaÃ§Ã£o | Package | Qty | PreÃ§o | LCSC |
|-----|------------|---------------|---------|-----|-------|------|
| U_REG | AP2112K-3.3 | LDO 3.3V 600mA | SOT-23-5 | 1 | â‚¬0.15 | C51118 |
| C_LDO_IN | 10ÂµF 10V | MLCC X5R | 0603 | 1 | â‚¬0.02 | C19702 |
| C_LDO_OUT | 10ÂµF 10V | MLCC X5R | 0603 | 1 | â‚¬0.02 | C19702 |
| LED1 | LED Verde | Power 5V | 0805 | 1 | â‚¬0.02 | C2297 |
| LED2 | LED Verde | Power 3.3V | 0805 | 1 | â‚¬0.02 | C2297 |
| R_LED1 | 1kÎ© | LED 5V | 0402 | 1 | â‚¬0.01 | C11702 |
| R_LED2 | 1kÎ© | LED 3.3V | 0402 | 1 | â‚¬0.01 | C11702 |
| **Total 3.3V** | | | | | **â‚¬0.25** | |

### 6.5 Resumo Total

| SecÃ§Ã£o | Custo |
|--------|-------|
| PSU (U10 IP2721 + Q3 MOSFET + U12 SY8368A + passivos) | â‚¬2.30 |
| Sensing (divisor ADC) | â‚¬0.03 |
| ProteÃ§Ãµes e Conectores (J1, F1, D3, D4, J3, J6) | â‚¬0.70 |
| Regulador 3.3V | â‚¬0.25 |
| **TOTAL PSU v3** | **~â‚¬3.30** |

> **Nota:**
> - U10 (IP2721) + Q3 (MOSFET): Power-path controlado, soft-start
> - U12 (SY8368AQQC): Buck de 8A (vs 3-5A anterior)
> - Melhor compatibilidade de fontes (fallback automÃ¡tico)
> - GestÃ£o automÃ¡tica de potÃªncia
> - Componentes Extended: U10, L1, J1, F1, D3, J3

---

## 7. Layout PCB

### 7.1 ConsideraÃ§Ãµes CrÃ­ticas

```
Layout Buck Converter - Boas PrÃ¡ticas:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  1. LOOP DE ALTA CORRENTE (minimizar Ã¡rea)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

     VIN â”€â”€â”¬â”€â”€[CIN]â”€â”€â”¬â”€â”€[SY8368 VIN/SW]â”€â”€[L1]â”€â”€â”¬â”€â”€[COUT]â”€â”€â”¬â”€â”€ VOUT
           â”‚         â”‚                         â”‚          â”‚
          GND       GND                       GND        GND
           â”‚         â”‚                         â”‚          â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–²
                         â”‚
                   MANTER ESTE LOOP
                   O MAIS CURTO POSSÃVEL!

  2. PLACEMENT
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                                         â”‚
     â”‚   [USB-C]                                               â”‚
     â”‚      â”‚                                                  â”‚
     â”‚      â–¼                                                  â”‚
     â”‚   [IP2721]  â—„â”€â”€ Perto do conector USB-C                â”‚
     â”‚      â”‚                                                  â”‚
     â”‚      â”‚  VOUT (15V)                                      â”‚
     â”‚      â–¼                                                  â”‚
     â”‚   [CIN x4] â”€â”€ Imediatamente ao lado do SY8368          â”‚
     â”‚      â”‚                                                  â”‚
     â”‚   [SY8368] â—„â”€â”€ Centro da Ã¡rea de potÃªncia              â”‚
     â”‚      â”‚                                                  â”‚
     â”‚   [L1] â”€â”€â”€â”€â”€â”€â”€â”€ Adjacente ao SW pin                    â”‚
     â”‚      â”‚                                                  â”‚
     â”‚   [COUT x6-8] â”€ DistribuÃ­dos apÃ³s L1                   â”‚
     â”‚      â”‚                                                  â”‚
     â”‚      â”‚  5V                                              â”‚
     â”‚      â–¼                                                  â”‚
     â”‚   [C_BULK] â”€â”€â”€â”€ Perto dos terminais de saÃ­da           â”‚
     â”‚      â”‚                                                  â”‚
     â”‚   [TERMINALS]                                           â”‚
     â”‚                                                         â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  3. PLANO DE GROUND
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â€¢ Usar plano de ground contÃ­nuo na layer inferior
  â€¢ Evitar cortar o plano sob o indutor
  â€¢ Vias mÃºltiplas nos pads PGND do SY8368
  â€¢ Separar ground analÃ³gico (ADC) do ground de potÃªncia
    com ferrite bead ou ligaÃ§Ã£o em ponto Ãºnico

  4. THERMAL
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  â€¢ Pad exposto do SY8368 ligado ao ground com vias tÃ©rmicas
  â€¢ MÃ­nimo 9 vias (3x3) no thermal pad
  â€¢ Copper pour na top layer para dissipaÃ§Ã£o

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 7.2 Footprint Indutor

```
OpÃ§Ãµes de Footprint para L1:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  OpÃ§Ã£o A: CKST0603 (6.6Ã—6.6Ã—3mm) - Compacto
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚
       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”‚
       â”‚   â”‚       â”‚   â”‚   6.6mm
       â”‚   â”‚  L1   â”‚   â”‚
       â”‚   â”‚       â”‚   â”‚
       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
       â”‚               â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           6.6mm

  OpÃ§Ã£o B: SRP1265 (12.5Ã—12.5Ã—6.5mm) - Alta corrente
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                       â”‚
       â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
       â”‚   â”‚               â”‚   â”‚   12.5mm
       â”‚   â”‚      L1       â”‚   â”‚
       â”‚   â”‚               â”‚   â”‚
       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
       â”‚                       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              12.5mm

  ğŸ’¡ RecomendaÃ§Ã£o: Desenhar footprint para o maior (SRP1265)
     que tambÃ©m aceita o menor (CKST0603 com ajuste de pads)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 8. Testes e ValidaÃ§Ã£o

### 8.1 Checklist de Testes

```
Testes de ValidaÃ§Ã£o PSU v3:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â–¡ CONTINUIDADE (antes de ligar)
    â”œâ”€ VIN nÃ£o curto com GND
    â”œâ”€ VOUT nÃ£o curto com GND
    â””â”€ Todos os componentes no lugar

  â–¡ POWER-ON (com fonte PD 15V)
    â”œâ”€ IP2721 negocia 15V (medir VOUT)
    â”œâ”€ SY8368 arranca (LED PWR acende)
    â”œâ”€ VOUT = 5.0V Â±2% (medir com multÃ­metro)
    â””â”€ Sem oscilaÃ§Ã£o audÃ­vel (coil whine)

  â–¡ EFICIÃŠNCIA
    â”œâ”€ Medir VIN, IIN
    â”œâ”€ Medir VOUT, IOUT
    â”œâ”€ Calcular: Î· = (VOUT Ã— IOUT) / (VIN Ã— IIN)
    â””â”€ Deve ser >90% @ 3A, >88% @ 6A

  â–¡ LOAD REGULATION
    â”œâ”€ VOUT @ 0A carga
    â”œâ”€ VOUT @ 3A carga
    â”œâ”€ VOUT @ 6A carga
    â””â”€ VariaÃ§Ã£o <2% (5.0V â†’ 4.9V aceitÃ¡vel)

  â–¡ TRANSIENT RESPONSE
    â”œâ”€ Aplicar carga de 0Aâ†’4A instantÃ¢neo
    â”œâ”€ Medir undershoot (deve ser <300mV)
    â”œâ”€ Remover carga 4Aâ†’0A
    â””â”€ Medir overshoot (deve ser <300mV)

  â–¡ FALLBACK 9V
    â”œâ”€ Usar fonte PD que sÃ³ tem 9V
    â”œâ”€ IP2721 negocia 9V
    â”œâ”€ SY8368 produz 5V
    â””â”€ Firmware detecta e capa brilho a 80%

  â–¡ FALLBACK 5V
    â”œâ”€ Usar carregador bÃ¡sico 5V/3A
    â”œâ”€ IP2721 fica em 5V (via resistÃªncias 5.1kÎ©)
    â”œâ”€ Buck em bypass (ou tensÃ£o mÃ­nima de saÃ­da)
    â””â”€ Firmware detecta e capa brilho a 40%

  â–¡ THERMAL
    â”œâ”€ OperaÃ§Ã£o contÃ­nua 30 min @ 5A
    â”œâ”€ Temperatura SY8368 <85Â°C
    â”œâ”€ Temperatura L1 <100Â°C
    â””â”€ Sem degradaÃ§Ã£o de performance

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 8.2 Equipamento NecessÃ¡rio

| Equipamento | Uso | Alternativa DIY |
|-------------|-----|-----------------|
| MultÃ­metro digital | Medir tensÃµes | - |
| Fonte PD 45W+ | Fornecer entrada | Carregador laptop USB-C |
| Carga electrÃ³nica | Teste de corrente | Resistores de potÃªncia |
| OsciloscÃ³pio | Ver ripple/transients | - (opcional) |
| TermÃ³metro IR | Medir temperaturas | Termopar + multÃ­metro |

---

## 9. ComparaÃ§Ã£o v2 â†’ v3

```
EvoluÃ§Ã£o da PSU:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CaracterÃ­stica         â”‚ v2              â”‚ v3              â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ PD Controller          â”‚ IP2721 / CYPD   â”‚ IP2721+AO3400A  â”‚
  â”‚ ConfiguraÃ§Ã£o           â”‚ Complexa        â”‚ Simples (1 res) â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ Buck Converter         â”‚ MP1584 (3A)     â”‚ SY8368 (8A)     â”‚
  â”‚                        â”‚ TPS54531 (5A)   â”‚                 â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ Corrente saÃ­da         â”‚ 3-5A            â”‚ 8A              â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ TensÃ£o preferida       â”‚ 12V ou 20V      â”‚ 15V             â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ Fallback               â”‚ Manual          â”‚ AutomÃ¡tico      â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ GestÃ£o brilho          â”‚ Manual/fixo     â”‚ AutomÃ¡tico ADC  â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ Custo                  â”‚ ~â‚¬3.25          â”‚ ~â‚¬4.25          â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ Compatibilidade        â”‚ ~70% fontes     â”‚ ~90% fontes     â”‚
  â”‚                        â”‚                 â”‚                 â”‚
  â”‚ Margem picos HUB75     â”‚ Limitada        â”‚ Excelente       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 10. ReferÃªncias

### Datasheets
- [IP2721 Datasheet](https://datasheet.lcsc.com/lcsc/2006111335_INJOINIC-IP2721_C603176.pdf) - INJOINIC
- [SY8368AQQC Datasheet](https://www.silergy.com/product/detail/SY8368) - Silergy
- [Indutor CKST Series](https://www.coilcraft.com) - Coilcraft

### Application Notes
- [IP2721 USB-C PD Application](https://aichiplink.com/blog/IP2721-Datasheet-Specifications-Schematic-Features-Alternative_389)
- [High Current Buck Design](https://www.ti.com/lit/an/slva477b/slva477b.pdf) - TI

### Projectos de ReferÃªncia
- [Hackaday TS100 USB-C](https://cdn.hackaday.io/files/1721877366848608/V1_2%20Schematic_TS100%20-%20USB%20C%20IP2721.pdf)
- [SY8368 Layout Tips](https://www.silergy.com/technical-documents)

---

*Documento criado: Janeiro 2025*
*VersÃ£o: 3.0 - USB-C PD 30W com Buck 8A*
*Baseado em: POWER_SUPPLY_v2.md*
